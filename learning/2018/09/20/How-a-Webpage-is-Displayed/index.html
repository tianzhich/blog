<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="preload" href="/blog/component---src-layouts-index-js-402b03e0db3e9461830c.js" as="script"/><link rel="preload" href="/blog/component---src-templates-blog-post-js-14060e765125310ecb9d.js" as="script"/><link rel="preload" href="/blog/path---learning-2018-09-20-how-a-webpage-is-displayed-0cbdfea97b526d18735d.js" as="script"/><link rel="preload" href="/blog/app-0e1cc0341dc892817918.js" as="script"/><link rel="preload" href="/blog/commons-b71de3ed6830857928d7.js" as="script"/><style data-styled-components="bxyceg gehMjS bSiphg kcTYKP oBVQk bDegaL iTVOQQ hviaMX iTVtfV eBbrmu gyetaY fyVvTi gUgLxq ljqDId TWaYf eESBAu jlbquj bZeHhw fIuKoY">
/* sc-component-id: sc-bdVaJa */
.bSiphg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:60px;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;} @media (max-width:599px){.bSiphg{height:40px;}} @media (max-width:1279px) and (min-width:600px){.bSiphg{height:50px;}} .bSiphg a{color:#ffffff;-webkit-text-decoration:none;text-decoration:none;} .bSiphg a:hover,.bSiphg a:active{color:#61dafb;-webkit-text-decoration:none;text-decoration:none;}
/* sc-component-id: sc-bwzfXH */
.kcTYKP{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-right:10px;height:100%;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;} @media (max-width:599px){.kcTYKP{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;}} @media (min-width:600px){.kcTYKP{width:calc(100% / 4);}} .kcTYKP svg{min-width:30px;} .kcTYKP span{color:#61dafb;font-weight:500;-webkit-letter-spacing:1px;-moz-letter-spacing:1px;-ms-letter-spacing:1px;letter-spacing:1px;font-size:20px;line-height:20px;margin-left:10px;} @media (max-width:599px){.kcTYKP span{position:absolute;overflow:hidden;height:1px;width:1px;margin:-1px;padding:0;border:0;}} @media (max-width:979px){.kcTYKP span{font-size:16px;margin-top:1px;}}
/* sc-component-id: sc-htpNat */
.oBVQk{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;overflow-x:auto;-webkit-overflow-scrolling:touch;height:100%;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;} @media (max-width:599px){.oBVQk{-webkit-mask-image:-webkit-linear-gradient(to right,transparent,black 20px,black 90%,transparent);mask-image:-webkit-linear-gradient(to right,transparent,black 20px,black 90%,transparent);-webkit-mask-image:linear-gradient(to right,transparent,black 20px,black 90%,transparent);}} @media (max-width:599px) and (min-width:0px){.oBVQk{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;}} .oBVQk a{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:#ffffff;-webkit-transition:color 0.2s ease-out;transition:color 0.2s ease-out;padding-left:15px;padding-right:15px;font-weight:300;white-space:nowrap;} @media (min-width:600px){.oBVQk a::after{content:"";}} .oBVQk a.active{color:#61dafb;} .oBVQk a.active::after{position:absolute;bottom:-1px;height:4px;background:#61dafb;left:0;right:0;} .oBVQk a:focus{outline:0;background-color:#373940;color:#ffffff;} @media (max-width:599px) and (min-width:0px){.oBVQk a{padding-left:8px;padding-right:8px;}} @media (max-width:979px) and (min-width:600px){.oBVQk a{padding-left:10px;padding-right:10px;}} @media (min-width:1280px){.oBVQk a{padding-left:20px;padding-right:20px;font-size:18px;}}
/* sc-component-id: sc-bxivhb */
.bDegaL{position:relative;cursor:pointer;height:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:0.5rem;padding-right:0.5rem;min-width:100px;color:#ffffff;font-weight:300;-webkit-transition:color 0.2s ease-out;transition:color 0.2s ease-out;} @media (max-width:979px){.bDegaL{margin-right:10px;}} @media (max-width:599px){.bDegaL{margin-right:0;min-width:0;margin-left:10px;}} @media (min-width:600px){.bDegaL{width:calc(100%/12);}} @media (min-width:1280px){.bDegaL{font-size:18px;}} .bDegaL div{display:none;position:absolute;background-color:#f9f9f9;width:120px;height:80px;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);line-height:20px;bottom:-80px;} .bDegaL:hover{color:#61dafb;} .bDegaL:hover div{display:block;} .bDegaL.clicked{color:#61dafb;} .bDegaL.clicked div{display:block;} .bDegaL a{float:none;color:black;padding:10px 12px;-webkit-text-decoration:none;text-decoration:none;display:block;text-align:left;-webkit-transition:color 0.2s ease-out;transition:color 0.2s ease-out;}
/* sc-component-id: sc-ifAKCX */
.iTVOQQ{text-align:center;} .iTVOQQ a{padding:5px 10px;margin-left:10px;white-space:nowrap;font-size:14px;font-weight:100;color:rgba(255,255,255,.9);-webkit-text-decoration:none;text-decoration:none;-webkit-transition:color 0.2s ease-out;transition:color 0.2s ease-out;} .iTVOQQ a svg{margin-left:5px;vertical-align:-2px;color:#6d6d6d;} @media (max-width:320px){.iTVOQQ{display:none;}} @media (max-width:459px){.iTVOQQ a{margin-left:0;}.iTVOQQ a span{display:none;}} @media (min-width:980px){.iTVOQQ{width:calc(100% / 6);}}
/* sc-component-id: sc-EHOje */
.bxyceg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100vh;}
/* sc-component-id: sc-bZQynM */
.gehMjS{background-color:#20232a;color:#ffffff;position:fixed;width:100%;top:0;left:0;z-index:2;} .gehMjS > div{padding-left:20px;padding-right:20px;margin-left:auto;margin-right:auto;} @media (min-width:780px){.gehMjS > div{width:90%;}} @media (min-width:1340px){.gehMjS > div{max-width:1260px;}}
/* sc-component-id: sc-gzVnrw */
.hviaMX{margin-top:60px;width:100%;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;} @media (max-width:1279px) and (min-width:780px){.hviaMX{margin-top:50px;}} @media (max-width:779px){.hviaMX{margin-top:40px;}}
/* sc-component-id: sc-htoDjs */
.iTVtfV{width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;overflow:hidden;}
/* sc-component-id: sc-dnqmqq */
.eBbrmu{width:100%;padding-left:20px;padding-right:20px;margin-left:auto;margin-right:auto;} @media (min-width:780px){.eBbrmu{width:90%;}} @media (min-width:1340px){.eBbrmu{max-width:1260px;}}
/* sc-component-id: sc-iwsKbI */
.fIuKoY{height:50px;width:100%;background:#20232a;color:#ffffff;position:relative;} .fIuKoY img{margin-bottom:0;} .fIuKoY p{line-height:50px;margin-bottom:0;text-align:center;} .fIuKoY a{color:#61dafb;} .fIuKoY a:hover{-webkit-text-decoration:none;text-decoration:none;}
/* sc-component-id: sc-gZMcBi */
.jlbquj{background-color:#20232a;bottom:44px;color:#61dafb;display:none;cursor:pointer;position:fixed;right:20px;z-index:3;border-radius:50%;border:1px solid rgba(255,255,255,0.1);box-shadow:0 0 20px rgba(0,0,0,0.3);} .jlbquj > div{padding-left:20px;padding-right:20px;margin-left:auto;margin-right:auto;}
/* sc-component-id: sc-gqjmRU */
.bZeHhw{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:60px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;} .bZeHhw > div{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:20px;height:20px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;} .bZeHhw svg:nth-child(1){-webkit-transform:rotateZ(180deg) translateY(4px);-ms-transform:rotateZ(180deg) translateY(4px);transform:rotateZ(180deg) translateY(4px);-webkit-transition:-webkit-transform 0.2s ease;-webkit-transition:transform 0.2s ease;transition:transform 0.2s ease;} .bZeHhw svg:nth-child(1).active{-webkit-transform:rotateZ(180deg) translateY(-8px);-ms-transform:rotateZ(180deg) translateY(-8px);transform:rotateZ(180deg) translateY(-8px);} .bZeHhw svg:nth-child(2){-webkit-transform:translateY(4px);-ms-transform:translateY(4px);transform:translateY(4px);-webkit-transition:-webkit-transform 0.2s ease;-webkit-transition:transform 0.2s ease;transition:transform 0.2s ease;} .bZeHhw svg:nth-child(2).active{-webkit-transform:translateY(-8px);-ms-transform:translateY(-8px);transform:translateY(-8px);}
/* sc-component-id: sc-VigVT */
@media (min-width:600px){.fyVvTi{margin-left:80px;border-left:1px solid rgb(236,236,236);}} @media (max-width:1339px) and (min-width:600px){.fyVvTi{margin-left:80px;-webkit-flex:0 0 200px;-ms-flex:0 0 200px;flex:0 0 200px;}} @media (max-width:979px) and (min-width:600px){.fyVvTi{margin-left:40px;}} @media (min-width:1100px){.fyVvTi{-webkit-flex:0 0 300px;-ms-flex:0 0 300px;flex:0 0 300px;}}
/* sc-component-id: sc-jTzLTM */
.gUgLxq{height:calc(100vh - 60px);padding-right:999px;margin-right:-999px;} @media (max-width:599px){.gUgLxq{-webkit-transition:opacity 0.5s ease;transition:opacity 0.5s ease;top:0px;left:0px;bottom:0px;right:0px;position:fixed;background-color:rgb(255,255,255);z-index:-1;height:100vh;overflow-y:auto;opacity:0;}.gUgLxq + div.action-button{display:block;}} @media (min-width:600px){.gUgLxq{position:fixed;overflow-y:auto;-webkit-overflow-scrolling:touch;background-color:#f7f7f7;opacity:1 !important;}} @media (max-width:779px) and (min-width:600px){.gUgLxq{height:calc(100vh - 40px);}} @media (max-width:1279px) and (min-width:780px){.gUgLxq{height:calc(100vh - 50px);}}
/* sc-component-id: sc-fjdhpX */
.ljqDId{margin-top:60px;-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0);-webkit-transition:-webkit-transform 0.5s ease;-webkit-transition:transform 0.5s ease;transition:transform 0.5s ease;} @media (max-width:599px){.ljqDId{margin-top:40px;-webkit-transform:translateY(40px);-ms-transform:translateY(40px);transform:translateY(40px);}} @media (max-width:979px) and (min-width:600px){.ljqDId{margin-top:0;}} @media (max-width:1279px) and (min-width:780px){.ljqDId{margin-top:50px;}} .ljqDId nav{width:100%;padding-left:20px;position:relative;} @media (min-width:1100px){.ljqDId nav{padding-left:40px;}}
/* sc-component-id: sc-jzJRlG */
.TWaYf{margin-top:10px;color:#6d6d6d;font-size:14px;font-weight:700;line-height:3;text-transform:uppercase;-webkit-letter-spacing:0.08em;-moz-letter-spacing:0.08em;-ms-letter-spacing:0.08em;letter-spacing:0.08em;} .TWaYf svg{margin-left:7px;-webkit-transform:rotateY(180deg);-ms-transform:rotateY(180deg);transform:rotateY(180deg);} @media (min-width:600px){.TWaYf{color:#1a1a1a;}}
/* sc-component-id: sc-cSHVUG */
.eESBAu{-webkit-transition:border 0.2s ease;transition:border 0.2s ease;list-style:none;margin-bottom:10px;margin-left:0;} .eESBAu > li{margin-top:10px;margin-bottom:0;} .eESBAu a{color:#1a1a1a;display:inline-block;-webkit-transition:border 0.2s ease;transition:border 0.2s ease;-webkit-text-decoration:none;text-decoration:none;} .eESBAu a:hover{color:#6d6d6d;outline-width:0;} .eESBAu a::before{width:4px;height:25px;content:'';border-left:4px solid #61dafb;padding-left:16px;position:absolute;left:0;visibility:hidden;} @media (min-width:1100px){.eESBAu a::before{left:15px;}} .eESBAu a.active{font-weight:700;} .eESBAu a.active:hover{color:#6d6d6d;} .eESBAu a.active::before{visibility:visible;} .eESBAu ul{list-style:none;margin-bottom:0px;margin-top:0;margin-left:20px;} .eESBAu ul li{margin-bottom:0;}
/* sc-component-id: sc-kAzzGY */
.gyetaY{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;} .gyetaY article{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;-webkit-flex-shrink:1;-ms-flex-negative:1;flex-shrink:1;-webkit-flex-basis:auto;-ms-flex-preferred-size:auto;flex-basis:auto;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;-webkit-align-items:stretch;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;padding-left:30px;margin-left:-30px;padding-right:30px;margin-right:-30px;overflow:hidden;} .gyetaY article header h1{margin-bottom:0;padding-bottom:0;border:none;} .gyetaY article header div{margin-top:15px;} .gyetaY article header p{margin-top:30px;color:#6d6d6d;margin-bottom:0;}</style><title data-react-helmet="true">To The Future</title><link data-react-helmet="true" rel="shortcut icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfiCBcOOCKih+TbAAACk0lEQVRIx5XUX2jVZRzH8ZfbpFAXqDlMvFAw540r5kSMoiRliBqB+KdmdREFKjijZRclUYwsrASZeCFOUS8UhOHEDS2bk0VZ0cxyY4d2Kv/lnxzH6aaba08XO87j9PzO8fu7+j3P9/18Pt/vl+fJ9XAx3CxlPvCIP43STd5DwEXesdQIxExTLEer89njc4XB76K3rXXdc9k5yLfOd6oG/4/Z4RkvOWRMNsoLXdJjY1L7ss1WahL0OmBqJrjAEv8IzusS9KpW7X0d+lxwyjdyoksoVuOs8ZiAOmd0ecxnSIhpslF/lPorugWdgqBDhSPKnBL0+UG9v8UNi8LfS+n5tz5Sb42ulLV+C6LwZfqTiT0+Vucru1LgIFgfhY90I5nWZrU25VpT0GuOWhFtf3kytcXrfvGh7hT8lnpLo0c31XZBELNYjb1DrAc1Ho/CJ4rZL4ib77B9Q+BaxdHq+U4KYjrN06B6EEw4qML0ByGpzch10Hyw0qt+VeZ3bf511kk5nlTrarR+eVJvm0Zf3Ff7URmjXRD8ZJ8N9+EtCjLh45JTLlfp9j1wp0+MSofdvUwzwQZF5gyuXnDcEXvdTK97J3W4hfhRgXyTcU3caT1+sz8KvxtvaNGn3Kcp1r/2VDboQP0/+0+VyuT17XPInOzQgRKKPO2chBId6jRLuKE1AznMFLf9NXDARLm2e1Sxi0qNVakxLThZiRlG69Wi7o6Dy2pN8rygwU7NadAir5nkD9/70pV7t0bYZLbZaV/Ikd60x7vpn/EXvZXW8kxb7Faa7gnJQ67pEg/YG2OFUs0+dya6n6v0enZIh+faqsoLcjLMQh6ecNwJjFeoUKEJLmm0Vk8meECLl3VYJM9VcXHtQzscHf8DgjIivFp2S+oAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDgtMjNUMTQ6NTY6MzQrMDI6MDDGWfzhAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTA4LTIzVDE0OjU2OjM0KzAyOjAwtwREXQAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAASUVORK5CYII="/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.625 -apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}h1{margin-left:0;margin-right:0;margin-top:2.4375rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.21875rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h2{margin-left:0;margin-right:0;margin-top:1.625rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.40625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:hsla(0,0%,0%,0.53);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}ul{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:0.85rem;line-height:1.625rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:1rem;line-height:1.625rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:calc(0.8125rem - 1px);padding-right:0;padding-top:0;margin-bottom:0.8125rem;border-left:4px solid hsla(0,0%,0%,0.13);color:hsla(0,0%,0%,0.53);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(0.8125rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}b{font-weight:600;}strong{font-weight:600;}dt{font-weight:600;}th{font-weight:600;}li{margin-bottom:calc(0.8125rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}li > ul{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(0.8125rem / 2);}code{font-size:0.85rem;line-height:1.625rem;}kbd{font-size:0.85rem;line-height:1.625rem;}samp{font-size:0.85rem;line-height:1.625rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.08333rem;padding-right:1.08333rem;padding-top:0.8125rem;padding-bottom:calc(0.8125rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}h3,h4,h5,h6{margin-bottom:0.8125rem;margin-top:1.625rem;}ol,ul{margin-left:2.03125rem;}li>ol,li>ul{margin-left:2.03125rem;}a{color:#4078c0;text-decoration:none;}a:hover,a:active{text-decoration:underline;}</style><style type="text/css">
    .anchor {
      float: left;
      padding-right: 4px;
      margin-left: -20px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var offset = element.offsetTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><style id="gatsby-inlined-css">body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Fira Sans,Droid Sans,Helvetica Neue,sans-serif}*,:after,:before{box-sizing:border-box}*{margin:0;padding:0}code[class*=language-]::-moz-selection,code[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}:not(pre)>code[class*=language-]{padding:0 3px;font-size:16px;word-break:break-word;background:rgba(255,229,100,.2);color:#1a1a1a}.token.keyword{color:#c5a5c5}.token.atrule,.token.class-name{color:#fac863}.token.punctuation{color:#5fb3b3}.token.function{color:#79b6f2}.token.entity,.token.operator,.token.url,.token.variable{color:#d7deea}.token.constant,.token.deleted,.token.function-name,.token.number,.token.property,.token.symbol{color:#5a9bcf}.token.tag{color:#fc929e}.token.attr-name{color:#c5a5c5}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.string{color:#8dc891}.token.selector{color:#ddca7e}.gatsby-highlight{margin:25px -30px;padding-left:15px;padding-right:15px;background:#282c34;color:#fff;border-radius:10px;overflow:auto;tab-size:1.5em;-moz-tab-size:1.5em;-o-tab-size:1.5em;line-height:20px;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}.gatsby-highlight pre[class*=language-]{height:auto!important;margin:1rem;font-size:14px;white-space:pre-wrap;word-break:break-word;line-height:20px}code{font-family:source-code-pro,Menlo,Monaco,Consolas,Courier New,monospace;font-size:inherit;line-height:inherit}.gatsby-highlight code[class*=language-]{color:#a6e22e}.gatsby-highlight-code-line{background-color:#14161a;display:block;margin:-.125rem calc(-1rem - 15px);padding:.125rem calc(1rem + 15px)}@font-face{font-family:KaTeX_AMS;src:url(/blog/static/KaTeX_AMS-Regular.3d8245dc.woff2) format("woff2"),url(/blog/static/KaTeX_AMS-Regular.ac1d46d9.woff) format("woff"),url(/blog/static/KaTeX_AMS-Regular.c67be87a.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Caligraphic;src:url(/blog/static/KaTeX_Caligraphic-Bold.970d3e76.woff2) format("woff2"),url(/blog/static/KaTeX_Caligraphic-Bold.445f96a3.woff) format("woff"),url(/blog/static/KaTeX_Caligraphic-Bold.3f61a84d.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Caligraphic;src:url(/blog/static/KaTeX_Caligraphic-Regular.0ef0f2e3.woff2) format("woff2"),url(/blog/static/KaTeX_Caligraphic-Regular.74f6918c.woff) format("woff"),url(/blog/static/KaTeX_Caligraphic-Regular.c3bc8fce.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Fraktur;src:url(/blog/static/KaTeX_Fraktur-Bold.950649ba.woff2) format("woff2"),url(/blog/static/KaTeX_Fraktur-Bold.1aca7ef7.woff) format("woff"),url(/blog/static/KaTeX_Fraktur-Bold.e11e6bf0.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Fraktur;src:url(/blog/static/KaTeX_Fraktur-Regular.135ccd74.woff2) format("woff2"),url(/blog/static/KaTeX_Fraktur-Regular.c5b430bf.woff) format("woff"),url(/blog/static/KaTeX_Fraktur-Regular.a9509497.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Main;src:url(/blog/static/KaTeX_Main-Bold.c5b67fb3.woff2) format("woff2"),url(/blog/static/KaTeX_Main-Bold.0ba875a1.woff) format("woff"),url(/blog/static/KaTeX_Main-Bold.aaaa1b76.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Main;src:url(/blog/static/KaTeX_Main-BoldItalic.0719833c.woff2) format("woff2"),url(/blog/static/KaTeX_Main-BoldItalic.5aeca883.woff) format("woff"),url(/blog/static/KaTeX_Main-BoldItalic.bdbadb27.ttf) format("truetype");font-weight:700;font-style:italic}@font-face{font-family:KaTeX_Main;src:url(/blog/static/KaTeX_Main-Italic.6bf61628.woff2) format("woff2"),url(/blog/static/KaTeX_Main-Italic.bb7c45db.woff) format("woff"),url(/blog/static/KaTeX_Main-Italic.2155d789.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:KaTeX_Main;src:url(/blog/static/KaTeX_Main-Regular.29b27903.woff2) format("woff2"),url(/blog/static/KaTeX_Main-Regular.1fd21713.woff) format("woff"),url(/blog/static/KaTeX_Main-Regular.7b8d1fa0.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Math;src:url(/blog/static/KaTeX_Math-Italic.7a31741a.woff2) format("woff2"),url(/blog/static/KaTeX_Math-Italic.8eb56b3f.woff) format("woff"),url(/blog/static/KaTeX_Math-Italic.10740d74.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:KaTeX_SansSerif;src:url(/blog/static/KaTeX_SansSerif-Bold.e38d0f68.woff2) format("woff2"),url(/blog/static/KaTeX_SansSerif-Bold.84299b01.woff) format("woff"),url(/blog/static/KaTeX_SansSerif-Bold.9123667c.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_SansSerif;src:url(/blog/static/KaTeX_SansSerif-Italic.1057b702.woff2) format("woff2"),url(/blog/static/KaTeX_SansSerif-Italic.95c5a3d4.woff) format("woff"),url(/blog/static/KaTeX_SansSerif-Italic.f9c440ab.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:KaTeX_SansSerif;src:url(/blog/static/KaTeX_SansSerif-Regular.f9e06d59.woff2) format("woff2"),url(/blog/static/KaTeX_SansSerif-Regular.35bda414.woff) format("woff"),url(/blog/static/KaTeX_SansSerif-Regular.2eae604d.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Script;src:url(/blog/static/KaTeX_Script-Regular.ae1fad1f.woff2) format("woff2"),url(/blog/static/KaTeX_Script-Regular.60febfa1.woff) format("woff"),url(/blog/static/KaTeX_Script-Regular.e9169ca7.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size1;src:url(/blog/static/KaTeX_Size1-Regular.fda0824e.woff2) format("woff2"),url(/blog/static/KaTeX_Size1-Regular.1d6cf6b8.woff) format("woff"),url(/blog/static/KaTeX_Size1-Regular.f2e296ef.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size2;src:url(/blog/static/KaTeX_Size2-Regular.a7a0eb93.woff2) format("woff2"),url(/blog/static/KaTeX_Size2-Regular.f48e83b7.woff) format("woff"),url(/blog/static/KaTeX_Size2-Regular.0767ede6.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size3;src:url(/blog/static/KaTeX_Size3-Regular.397bd687.woff2) format("woff2"),url(/blog/static/KaTeX_Size3-Regular.0387ab38.woff) format("woff"),url(/blog/static/KaTeX_Size3-Regular.882f7234.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size4;src:url(/blog/static/KaTeX_Size4-Regular.3c14ed11.woff2) format("woff2"),url(/blog/static/KaTeX_Size4-Regular.726db3bd.woff) format("woff"),url(/blog/static/KaTeX_Size4-Regular.27901d5c.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Typewriter;src:url(/blog/static/KaTeX_Typewriter-Regular.f43e8696.woff2) format("woff2"),url(/blog/static/KaTeX_Typewriter-Regular.ba01f72a.woff) format("woff"),url(/blog/static/KaTeX_Typewriter-Regular.6b9645af.ttf) format("truetype");font-weight:400;font-style:normal}.katex-display{display:block;margin:1em 0;text-align:center}.katex-display>.katex{display:inline-block;text-align:left;text-align:initial}.katex{font:normal 1.21em KaTeX_Main,Times New Roman,serif;line-height:1.2;white-space:nowrap;text-indent:0;text-rendering:auto}.katex *{-ms-high-contrast-adjust:none!important}.katex .katex-html{display:inline-block}.katex .katex-mathml{position:absolute;clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}.katex .base{position:relative}.katex .base,.katex .strut{display:inline-block}.katex .textbf{font-weight:700}.katex .textit{font-style:italic}.katex .textrm{font-family:KaTeX_Main}.katex .textsf{font-family:KaTeX_SansSerif}.katex .texttt{font-family:KaTeX_Typewriter}.katex .mathit{font-family:KaTeX_Math;font-style:italic}.katex .mathrm{font-style:normal}.katex .mathbf{font-family:KaTeX_Main;font-weight:700}.katex .boldsymbol{font-family:KaTeX_Math;font-weight:700;font-style:italic}.katex .amsrm,.katex .mathbb{font-family:KaTeX_AMS}.katex .mathcal{font-family:KaTeX_Caligraphic}.katex .mathfrak{font-family:KaTeX_Fraktur}.katex .mathtt{font-family:KaTeX_Typewriter}.katex .mathscr{font-family:KaTeX_Script}.katex .mathsf{font-family:KaTeX_SansSerif}.katex .mainit{font-family:KaTeX_Main;font-style:italic}.katex .mainrm{font-family:KaTeX_Main;font-style:normal}.katex .vlist-t{display:inline-table;table-layout:fixed}.katex .vlist-r{display:table-row}.katex .vlist{display:table-cell;vertical-align:bottom;position:relative}.katex .vlist>span{display:block;height:0;position:relative}.katex .vlist>span>span{display:inline-block}.katex .vlist>span>.pstrut{overflow:hidden;width:0}.katex .vlist-t2{margin-right:-2px}.katex .vlist-s{display:table-cell;vertical-align:bottom;font-size:1px;width:2px}.katex .msupsub{text-align:left}.katex .mfrac>span>span{text-align:center}.katex .mfrac .frac-line{display:inline-block;width:100%}.katex .mspace{display:inline-block}.katex .mspace.negativethinspace{margin-left:-.16667em}.katex .mspace.muspace{width:.055556em}.katex .mspace.thinspace{width:.16667em}.katex .mspace.negativemediumspace{margin-left:-.22222em}.katex .mspace.mediumspace{width:.22222em}.katex .mspace.thickspace{width:.27778em}.katex .mspace.sixmuspace{width:.333333em}.katex .mspace.eightmuspace{width:.444444em}.katex .mspace.enspace{width:.5em}.katex .mspace.twelvemuspace{width:.666667em}.katex .mspace.quad{width:1em}.katex .mspace.qquad{width:2em}.katex .clap,.katex .llap,.katex .rlap{width:0;position:relative}.katex .clap>.inner,.katex .llap>.inner,.katex .rlap>.inner{position:absolute}.katex .clap>.fix,.katex .llap>.fix,.katex .rlap>.fix{display:inline-block}.katex .llap>.inner{right:0}.katex .clap>.inner,.katex .rlap>.inner{left:0}.katex .clap>.inner>span{margin-left:-50%;margin-right:50%}.katex .rule{display:inline-block;border:0 solid;position:relative}.katex .overline .overline-line,.katex .underline .underline-line{display:inline-block;width:100%}.katex .sqrt>.root{margin-left:.27777778em;margin-right:-.55555556em}.katex .fontsize-ensurer,.katex .sizing{display:inline-block}.katex .fontsize-ensurer.reset-size1.size1,.katex .sizing.reset-size1.size1{font-size:1em}.katex .fontsize-ensurer.reset-size1.size2,.katex .sizing.reset-size1.size2{font-size:1.2em}.katex .fontsize-ensurer.reset-size1.size3,.katex .sizing.reset-size1.size3{font-size:1.4em}.katex .fontsize-ensurer.reset-size1.size4,.katex .sizing.reset-size1.size4{font-size:1.6em}.katex .fontsize-ensurer.reset-size1.size5,.katex .sizing.reset-size1.size5{font-size:1.8em}.katex .fontsize-ensurer.reset-size1.size6,.katex .sizing.reset-size1.size6{font-size:2em}.katex .fontsize-ensurer.reset-size1.size7,.katex .sizing.reset-size1.size7{font-size:2.4em}.katex .fontsize-ensurer.reset-size1.size8,.katex .sizing.reset-size1.size8{font-size:2.88em}.katex .fontsize-ensurer.reset-size1.size9,.katex .sizing.reset-size1.size9{font-size:3.456em}.katex .fontsize-ensurer.reset-size1.size10,.katex .sizing.reset-size1.size10{font-size:4.148em}.katex .fontsize-ensurer.reset-size1.size11,.katex .sizing.reset-size1.size11{font-size:4.976em}.katex .fontsize-ensurer.reset-size2.size1,.katex .sizing.reset-size2.size1{font-size:.83333333em}.katex .fontsize-ensurer.reset-size2.size2,.katex .sizing.reset-size2.size2{font-size:1em}.katex .fontsize-ensurer.reset-size2.size3,.katex .sizing.reset-size2.size3{font-size:1.16666667em}.katex .fontsize-ensurer.reset-size2.size4,.katex .sizing.reset-size2.size4{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size2.size5,.katex .sizing.reset-size2.size5{font-size:1.5em}.katex .fontsize-ensurer.reset-size2.size6,.katex .sizing.reset-size2.size6{font-size:1.66666667em}.katex .fontsize-ensurer.reset-size2.size7,.katex .sizing.reset-size2.size7{font-size:2em}.katex .fontsize-ensurer.reset-size2.size8,.katex .sizing.reset-size2.size8{font-size:2.4em}.katex .fontsize-ensurer.reset-size2.size9,.katex .sizing.reset-size2.size9{font-size:2.88em}.katex .fontsize-ensurer.reset-size2.size10,.katex .sizing.reset-size2.size10{font-size:3.45666667em}.katex .fontsize-ensurer.reset-size2.size11,.katex .sizing.reset-size2.size11{font-size:4.14666667em}.katex .fontsize-ensurer.reset-size3.size1,.katex .sizing.reset-size3.size1{font-size:.71428571em}.katex .fontsize-ensurer.reset-size3.size2,.katex .sizing.reset-size3.size2{font-size:.85714286em}.katex .fontsize-ensurer.reset-size3.size3,.katex .sizing.reset-size3.size3{font-size:1em}.katex .fontsize-ensurer.reset-size3.size4,.katex .sizing.reset-size3.size4{font-size:1.14285714em}.katex .fontsize-ensurer.reset-size3.size5,.katex .sizing.reset-size3.size5{font-size:1.28571429em}.katex .fontsize-ensurer.reset-size3.size6,.katex .sizing.reset-size3.size6{font-size:1.42857143em}.katex .fontsize-ensurer.reset-size3.size7,.katex .sizing.reset-size3.size7{font-size:1.71428571em}.katex .fontsize-ensurer.reset-size3.size8,.katex .sizing.reset-size3.size8{font-size:2.05714286em}.katex .fontsize-ensurer.reset-size3.size9,.katex .sizing.reset-size3.size9{font-size:2.46857143em}.katex .fontsize-ensurer.reset-size3.size10,.katex .sizing.reset-size3.size10{font-size:2.96285714em}.katex .fontsize-ensurer.reset-size3.size11,.katex .sizing.reset-size3.size11{font-size:3.55428571em}.katex .fontsize-ensurer.reset-size4.size1,.katex .sizing.reset-size4.size1{font-size:.625em}.katex .fontsize-ensurer.reset-size4.size2,.katex .sizing.reset-size4.size2{font-size:.75em}.katex .fontsize-ensurer.reset-size4.size3,.katex .sizing.reset-size4.size3{font-size:.875em}.katex .fontsize-ensurer.reset-size4.size4,.katex .sizing.reset-size4.size4{font-size:1em}.katex .fontsize-ensurer.reset-size4.size5,.katex .sizing.reset-size4.size5{font-size:1.125em}.katex .fontsize-ensurer.reset-size4.size6,.katex .sizing.reset-size4.size6{font-size:1.25em}.katex .fontsize-ensurer.reset-size4.size7,.katex .sizing.reset-size4.size7{font-size:1.5em}.katex .fontsize-ensurer.reset-size4.size8,.katex .sizing.reset-size4.size8{font-size:1.8em}.katex .fontsize-ensurer.reset-size4.size9,.katex .sizing.reset-size4.size9{font-size:2.16em}.katex .fontsize-ensurer.reset-size4.size10,.katex .sizing.reset-size4.size10{font-size:2.5925em}.katex .fontsize-ensurer.reset-size4.size11,.katex .sizing.reset-size4.size11{font-size:3.11em}.katex .fontsize-ensurer.reset-size5.size1,.katex .sizing.reset-size5.size1{font-size:.55555556em}.katex .fontsize-ensurer.reset-size5.size2,.katex .sizing.reset-size5.size2{font-size:.66666667em}.katex .fontsize-ensurer.reset-size5.size3,.katex .sizing.reset-size5.size3{font-size:.77777778em}.katex .fontsize-ensurer.reset-size5.size4,.katex .sizing.reset-size5.size4{font-size:.88888889em}.katex .fontsize-ensurer.reset-size5.size5,.katex .sizing.reset-size5.size5{font-size:1em}.katex .fontsize-ensurer.reset-size5.size6,.katex .sizing.reset-size5.size6{font-size:1.11111111em}.katex .fontsize-ensurer.reset-size5.size7,.katex .sizing.reset-size5.size7{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size5.size8,.katex .sizing.reset-size5.size8{font-size:1.6em}.katex .fontsize-ensurer.reset-size5.size9,.katex .sizing.reset-size5.size9{font-size:1.92em}.katex .fontsize-ensurer.reset-size5.size10,.katex .sizing.reset-size5.size10{font-size:2.30444444em}.katex .fontsize-ensurer.reset-size5.size11,.katex .sizing.reset-size5.size11{font-size:2.76444444em}.katex .fontsize-ensurer.reset-size6.size1,.katex .sizing.reset-size6.size1{font-size:.5em}.katex .fontsize-ensurer.reset-size6.size2,.katex .sizing.reset-size6.size2{font-size:.6em}.katex .fontsize-ensurer.reset-size6.size3,.katex .sizing.reset-size6.size3{font-size:.7em}.katex .fontsize-ensurer.reset-size6.size4,.katex .sizing.reset-size6.size4{font-size:.8em}.katex .fontsize-ensurer.reset-size6.size5,.katex .sizing.reset-size6.size5{font-size:.9em}.katex .fontsize-ensurer.reset-size6.size6,.katex .sizing.reset-size6.size6{font-size:1em}.katex .fontsize-ensurer.reset-size6.size7,.katex .sizing.reset-size6.size7{font-size:1.2em}.katex .fontsize-ensurer.reset-size6.size8,.katex .sizing.reset-size6.size8{font-size:1.44em}.katex .fontsize-ensurer.reset-size6.size9,.katex .sizing.reset-size6.size9{font-size:1.728em}.katex .fontsize-ensurer.reset-size6.size10,.katex .sizing.reset-size6.size10{font-size:2.074em}.katex .fontsize-ensurer.reset-size6.size11,.katex .sizing.reset-size6.size11{font-size:2.488em}.katex .fontsize-ensurer.reset-size7.size1,.katex .sizing.reset-size7.size1{font-size:.41666667em}.katex .fontsize-ensurer.reset-size7.size2,.katex .sizing.reset-size7.size2{font-size:.5em}.katex .fontsize-ensurer.reset-size7.size3,.katex .sizing.reset-size7.size3{font-size:.58333333em}.katex .fontsize-ensurer.reset-size7.size4,.katex .sizing.reset-size7.size4{font-size:.66666667em}.katex .fontsize-ensurer.reset-size7.size5,.katex .sizing.reset-size7.size5{font-size:.75em}.katex .fontsize-ensurer.reset-size7.size6,.katex .sizing.reset-size7.size6{font-size:.83333333em}.katex .fontsize-ensurer.reset-size7.size7,.katex .sizing.reset-size7.size7{font-size:1em}.katex .fontsize-ensurer.reset-size7.size8,.katex .sizing.reset-size7.size8{font-size:1.2em}.katex .fontsize-ensurer.reset-size7.size9,.katex .sizing.reset-size7.size9{font-size:1.44em}.katex .fontsize-ensurer.reset-size7.size10,.katex .sizing.reset-size7.size10{font-size:1.72833333em}.katex .fontsize-ensurer.reset-size7.size11,.katex .sizing.reset-size7.size11{font-size:2.07333333em}.katex .fontsize-ensurer.reset-size8.size1,.katex .sizing.reset-size8.size1{font-size:.34722222em}.katex .fontsize-ensurer.reset-size8.size2,.katex .sizing.reset-size8.size2{font-size:.41666667em}.katex .fontsize-ensurer.reset-size8.size3,.katex .sizing.reset-size8.size3{font-size:.48611111em}.katex .fontsize-ensurer.reset-size8.size4,.katex .sizing.reset-size8.size4{font-size:.55555556em}.katex .fontsize-ensurer.reset-size8.size5,.katex .sizing.reset-size8.size5{font-size:.625em}.katex .fontsize-ensurer.reset-size8.size6,.katex .sizing.reset-size8.size6{font-size:.69444444em}.katex .fontsize-ensurer.reset-size8.size7,.katex .sizing.reset-size8.size7{font-size:.83333333em}.katex .fontsize-ensurer.reset-size8.size8,.katex .sizing.reset-size8.size8{font-size:1em}.katex .fontsize-ensurer.reset-size8.size9,.katex .sizing.reset-size8.size9{font-size:1.2em}.katex .fontsize-ensurer.reset-size8.size10,.katex .sizing.reset-size8.size10{font-size:1.44027778em}.katex .fontsize-ensurer.reset-size8.size11,.katex .sizing.reset-size8.size11{font-size:1.72777778em}.katex .fontsize-ensurer.reset-size9.size1,.katex .sizing.reset-size9.size1{font-size:.28935185em}.katex .fontsize-ensurer.reset-size9.size2,.katex .sizing.reset-size9.size2{font-size:.34722222em}.katex .fontsize-ensurer.reset-size9.size3,.katex .sizing.reset-size9.size3{font-size:.40509259em}.katex .fontsize-ensurer.reset-size9.size4,.katex .sizing.reset-size9.size4{font-size:.46296296em}.katex .fontsize-ensurer.reset-size9.size5,.katex .sizing.reset-size9.size5{font-size:.52083333em}.katex .fontsize-ensurer.reset-size9.size6,.katex .sizing.reset-size9.size6{font-size:.5787037em}.katex .fontsize-ensurer.reset-size9.size7,.katex .sizing.reset-size9.size7{font-size:.69444444em}.katex .fontsize-ensurer.reset-size9.size8,.katex .sizing.reset-size9.size8{font-size:.83333333em}.katex .fontsize-ensurer.reset-size9.size9,.katex .sizing.reset-size9.size9{font-size:1em}.katex .fontsize-ensurer.reset-size9.size10,.katex .sizing.reset-size9.size10{font-size:1.20023148em}.katex .fontsize-ensurer.reset-size9.size11,.katex .sizing.reset-size9.size11{font-size:1.43981481em}.katex .fontsize-ensurer.reset-size10.size1,.katex .sizing.reset-size10.size1{font-size:.24108004em}.katex .fontsize-ensurer.reset-size10.size2,.katex .sizing.reset-size10.size2{font-size:.28929605em}.katex .fontsize-ensurer.reset-size10.size3,.katex .sizing.reset-size10.size3{font-size:.33751205em}.katex .fontsize-ensurer.reset-size10.size4,.katex .sizing.reset-size10.size4{font-size:.38572806em}.katex .fontsize-ensurer.reset-size10.size5,.katex .sizing.reset-size10.size5{font-size:.43394407em}.katex .fontsize-ensurer.reset-size10.size6,.katex .sizing.reset-size10.size6{font-size:.48216008em}.katex .fontsize-ensurer.reset-size10.size7,.katex .sizing.reset-size10.size7{font-size:.57859209em}.katex .fontsize-ensurer.reset-size10.size8,.katex .sizing.reset-size10.size8{font-size:.69431051em}.katex .fontsize-ensurer.reset-size10.size9,.katex .sizing.reset-size10.size9{font-size:.83317261em}.katex .fontsize-ensurer.reset-size10.size10,.katex .sizing.reset-size10.size10{font-size:1em}.katex .fontsize-ensurer.reset-size10.size11,.katex .sizing.reset-size10.size11{font-size:1.19961427em}.katex .fontsize-ensurer.reset-size11.size1,.katex .sizing.reset-size11.size1{font-size:.20096463em}.katex .fontsize-ensurer.reset-size11.size2,.katex .sizing.reset-size11.size2{font-size:.24115756em}.katex .fontsize-ensurer.reset-size11.size3,.katex .sizing.reset-size11.size3{font-size:.28135048em}.katex .fontsize-ensurer.reset-size11.size4,.katex .sizing.reset-size11.size4{font-size:.32154341em}.katex .fontsize-ensurer.reset-size11.size5,.katex .sizing.reset-size11.size5{font-size:.36173633em}.katex .fontsize-ensurer.reset-size11.size6,.katex .sizing.reset-size11.size6{font-size:.40192926em}.katex .fontsize-ensurer.reset-size11.size7,.katex .sizing.reset-size11.size7{font-size:.48231511em}.katex .fontsize-ensurer.reset-size11.size8,.katex .sizing.reset-size11.size8{font-size:.57877814em}.katex .fontsize-ensurer.reset-size11.size9,.katex .sizing.reset-size11.size9{font-size:.69453376em}.katex .fontsize-ensurer.reset-size11.size10,.katex .sizing.reset-size11.size10{font-size:.83360129em}.katex .fontsize-ensurer.reset-size11.size11,.katex .sizing.reset-size11.size11{font-size:1em}.katex .delimsizing.size1{font-family:KaTeX_Size1}.katex .delimsizing.size2{font-family:KaTeX_Size2}.katex .delimsizing.size3{font-family:KaTeX_Size3}.katex .delimsizing.size4{font-family:KaTeX_Size4}.katex .delimsizing.mult .delim-size1>span{font-family:KaTeX_Size1}.katex .delimsizing.mult .delim-size4>span{font-family:KaTeX_Size4}.katex .nulldelimiter{display:inline-block;width:.12em}.katex .delimcenter,.katex .op-symbol{position:relative}.katex .op-symbol.small-op{font-family:KaTeX_Size1}.katex .op-symbol.large-op{font-family:KaTeX_Size2}.katex .accent>.vlist-t,.katex .op-limits>.vlist-t{text-align:center}.katex .accent .accent-body{width:0;position:relative}.katex .overlay{display:block}.katex .mtable .vertical-separator{display:inline-block;margin:0 -.125em;width:.25em;overflow:hidden;position:relative}.katex .mtable .arraycolsep{display:inline-block}.katex .mtable .col-align-c>.vlist-t{text-align:center}.katex .mtable .col-align-l>.vlist-t{text-align:left}.katex .mtable .col-align-r>.vlist-t{text-align:right}.katex .svg-align{text-align:left}.katex svg{display:block;position:absolute;width:100%;fill:currentColor;stroke:currentColor;fill-rule:nonzero;fill-opacity:1;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1}.katex svg path{stroke:none}.katex .vertical-separator svg{width:.25em}.katex .stretchy{width:100%;display:block;position:relative;overflow:hidden}.katex .stretchy:after,.katex .stretchy:before{content:""}.katex .hide-tail{width:100%;position:relative;overflow:hidden}.katex .halfarrow-left{position:absolute;left:0;width:50.2%;overflow:hidden}.katex .halfarrow-right{position:absolute;right:0;width:50.2%;overflow:hidden}.katex .brace-left{position:absolute;left:0;width:25.1%;overflow:hidden}.katex .brace-center{position:absolute;left:25%;width:50%;overflow:hidden}.katex .brace-right{position:absolute;right:0;width:25.1%;overflow:hidden}.katex .x-arrow-pad{padding:0 .5em}.katex .mover,.katex .munder,.katex .x-arrow{text-align:center}.katex .boxpad{padding:0 .3em}.katex .fbox{box-sizing:border-box;border:.04em solid #000}.katex .fcolorbox{box-sizing:border-box;border:.04em solid}.katex .cancel-pad{padding:0 .2em}.katex .cancel-lap+.mbin,.katex .cancel-lap+.mord,.katex .cancel-lap+.msupsub,.katex .mbin+.cancel-lap,.katex .mord+.cancel-lap{margin-left:-.2em}.katex .sout{border-bottom-style:solid;border-bottom-width:.08em}pre{overflow-x:auto}article ol,article ul{margin-left:32px}h2:before,h3:before,h4:before,h5:before,h6:before{display:block;content:"";height:70px;margin-top:-70px;visibility:hidden}article blockquote{background-color:rgba(255,229,100,.3);border-left-color:#ffe564;border-left-width:9px;border-left-style:solid;padding:20px 45px 20px 26px;margin:20px -30px 30px}article a:not(.anchor):not(.gatsby-resp-image-link){background-color:rgba(187,239,253,.3);border-bottom:1px solid rgba(0,0,0,.2);color:#1a1a1a;text-decoration:none}article a:not(.anchor):not(.gatsby-resp-image-link):hover{background-color:#bbeffd;border-bottom-color:#1a1a1a}article table{display:block;margin:0 auto 16px;width:100%;overflow:auto;table-layout:fixed;border-spacing:0;border-collapse:collapse}article table tr{background-color:#fff;border-top:1px solid #c6cbd1}article table tr:nth-child(2n){background-color:#f6f8fa}article table td,article table th{padding:6px 13px;border:1px solid #dfe2e5}article table td:first-child,article table td:last-child,article table th:first-child,article table th:last-child{padding:6px 13px}:not(.katex-display) .katex-html{background-color:#dadada}ol .katex-display,ul .katex-display{margin-left:-62px}.katex-display{overflow-x:scroll;background-color:#dadada;margin-left:-30px;margin-right:-30px;padding-left:15px;padding-right:15px;border-radius:10px}.katex-display .katex{padding:1rem}a.gatsby-resp-image-link+span{display:block;margin-top:5px;text-align:center;font-size:.9em}</style></head><body><div id="___gatsby"><div class="sc-EHOje bxyceg" data-reactroot=""><header class="sc-bZQynM gehMjS"><div class="sc-bdVaJa bSiphg"><a class="sc-bwzfXH kcTYKP" href="/blog/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 331.331 331.331" height="30"><g><path d="M30.421,317.462l4.422-17.661l-12.194-4.814l-8.376,13.804c0,0,4.618,12.526-0.511,22.539   C13.766,331.331,20.184,320.399,30.421,317.462z M22.229,309.358c1.501-0.615,3.231,0.087,3.851,1.561   c0.625,1.474-0.087,3.171-1.588,3.786c-1.501,0.615-3.231-0.087-3.851-1.561C20.01,311.664,20.723,309.967,22.229,309.358z" fill="#ffffff"></path><path d="M158.353,112.621c-35.115,28.8-81.086,88.124-120.073,157.423l-0.022-0.027l-6.815,12.026   l7.267,2.796l3.84-10.117c20.799-37.491,77.224-135.4,180.397-200.451c0,0,38.411-22.877,76.256-54.516   c-9.214,7.702-27.391,17.356-37.247,23.584C236.088,59.683,204.166,75.043,158.353,112.621z" fill="#ffffff"></path><path d="M33.2,215.365c-7.985,28.223-7.528,49.718-4.438,55.625h4.83   c13.337-27.625,77.572-127.693,117.554-159.016c41.424-32.455,73.378-51.339,100.253-65.111   c9.437-4.835,19.118-11.384,27.848-17.949c10.601-8.36,21.348-17.302,30.758-26.053L282.728,20.75L294.89,2.148L271.67,25.759   L286.78,0c-35.746,3.225-68.918,21.109-68.918,21.109c-13.271,15.741-23.959,40.782-23.959,40.782   c-0.37-12.521,8.11-31.481,8.11-31.481c-6.266,2.861-30.073,16.459-30.073,16.459c-11.645,9.66-15.262,35.06-15.262,35.06   c-2.214-10.019,5.526-29.333,5.526-29.333c-33.543,19.32-57.502,52.231-57.502,52.231c-16.584,32.553-2.948,57.953-8.11,51.872   c-5.162-6.081-4.052-28.261-4.052-28.261c-35.017,33.63-38.699,49.724-38.699,49.724c-5.896,14.31-11.058,52.59-11.058,52.59   c-3.318-3.579,0-23.611,0-23.611c-8.479,17.889-4.422,34.701-4.422,34.701C34.309,240.407,33.2,215.365,33.2,215.365z" fill="#ffffff"></path><path d="M310.01,14.191c0,0-13.483,13.065-30.758,26.053c-27.081,21.359-53.156,38.819-53.156,38.819   C123.945,139.425,67.025,237.932,48.212,271.708h10.002c3.535-2.834,8.844-4.971,31.014-11.389   c28.011-8.11,44.72-25.041,44.72-25.041s-25.553,14.31-37.595,12.88s-28.223,3.1-28.223,3.1s-6.179-2.861,24.291-7.392   s80.596-38.634,80.596-38.634s-19.167,7.87-28.011,7.152c-8.844-0.718-30.714,0-30.714,0c14.495-3.34,28.011-1.43,50.126-9.779   c22.115-8.349,20.886-7.631,20.886-7.631c25.063-8.349,35.474-34.342,35.474-34.342c-4.335,1.67-37.443,5.722-51.176,1.67   c-13.734-4.052-37.132,0-37.132,0c22.115-7.392,27.032-4.052,32.433-4.291c5.406-0.239,22.855,1.191,57.502-10.731   s44.475-26.711,44.475-26.711l-23.366,3.122c15.257-2.567,32.455-12.662,32.455-12.662c-10.568,2.861-27.032,4.291-27.032,4.291   c19.412-4.291,30.225-10.253,30.225-10.253c18.183-13.832,22.36-34.342,22.36-34.342c-25.803,8.822-46.194,4.77-46.194,4.77   c35.387-2.382,45.215-11.449,50.126-13.592c4.917-2.148,6.94-11.03,6.94-11.03c-17.878,6.44-38.15,7.511-38.15,7.511   c21.93-3.399,40.722-14.49,40.722-14.49V32.792c-8.479,4.83-23.399,8.588-23.399,8.588l23.219-15.023   C316.091,18.841,310.01,14.191,310.01,14.191z" fill="#ffffff"></path><polygon points="23.551,290.571 37.361,296.103 39.933,289.989 26.124,284.458  " fill="#ffffff"></polygon><path d="M177.036,285.458c-45.628,21.936-89.462,36.888-147.758,38.846c-5.439,0.185-5.466,5.624,0,5.439   c52.15-1.751,95.543-12.961,137.391-32.575c46.618-21.854,89.435-40.167,147.828-46.39c5.385-0.577,3.095-5.814-2.252-5.243   C260.531,251.051,218.514,265.519,177.036,285.458z" fill="#ffffff"></path></g></svg><span>TIANZHICH</span></a><nav class="sc-htpNat oBVQk"><a class="" href="/blog/learning">Learning</a><a class="" href="/blog/life">Life</a><a class="" href="/blog/fitness">Fitness</a></nav><div class="sc-bxivhb bDegaL">Friends<div><a href="https://best921.github.io/">小泽的博客</a><a href="https://takikuzhu.github.io/">Ting的博客</a></div></div><div class="sc-ifAKCX iTVOQQ"><a href="https://github.com/tianzhich" target="_blank"><span>Github</span><svg x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div></div></header><div class="sc-gzVnrw hviaMX"><div class="sc-htoDjs iTVtfV"><div class="sc-dnqmqq eBbrmu"><div class="sc-kAzzGY gyetaY"><article><header><h1>深入理解浏览器解析渲染HTML</h1><div>September 20, 2018 by Tian Zhi</div><p>除了知道如何用代码实现一个页面之外，最重要的是明白这个页面是如何被浏览器解析和渲染，并最终呈现在我们面前的</p></header><div><h2 id="前言"><a href="#%E5%89%8D%E8%A8%80" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>前言</h2>
<p>回顾自己的前端学习历程，现在都还不能深入理解浏览器对HTML文档的解析和渲染过程。最近被问到HTML的重绘(Repaint)和重排(Reflow)，才想起自己根本没仔细研究过它。</p>
<p>作为前端工程师，我们每天写HTML，CSS和JavaScript，但是浏览器是如何解析这些文件，最终将它们以像素显示在屏幕上的呢？</p>
<p>这一过程叫做<em>Critical Rendering Path</em></p>
<h2 id="critical-rendering-path"><a href="#critical-rendering-path" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Critical Rendering Path</h2>
<p><em>Critical Rendering Path</em>，中文翻译过来，叫做<strong>关键渲染路径</strong>。指的是浏览器从请求HTML，CSS，JavaScript文件开始，到将它们最终以像素输出到屏幕上这一过程。包括以下几个部分</p>
<ol>
<li>
<p>构建DOM</p>
<ul>
<li>将HTML解析成许多Tokens</li>
<li>将Tokens解析成object</li>
<li>将object组合成为一个DOM树</li>
</ul>
</li>
<li>
<p>构建CSSOM</p>
<ul>
<li>解析CSS文件，并构建出一个CSSOM树（过程类似于DOM构建）</li>
</ul>
</li>
<li>
<p>构建Render Tree</p>
<ul>
<li>结合DOM和CSSOM构建出一颗Render树</li>
</ul>
</li>
<li>
<p>Layout</p>
<ul>
<li>计算出元素相对于viewport的相对位置</li>
</ul>
</li>
<li>
<p>Paint</p>
<ul>
<li>将render tree转换成像素，显示在屏幕上</li>
</ul>
</li>
</ol>
<p>值得注意的是，上面的过程并不是依次进行的，而是存在一定交叉，后面会详细解释</p>
<p>想要提高网页加载速度，提升用户体验，就需要在第一次加载时让重要的元素尽快显示在屏幕上。而不是等所有元素全部准备就绪再显示，下面一幅图说明了这两种方式的差异</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/progressive-rendering-e58351df6b94ecd408d64131f9282fe2-a5e4a.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 611px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 49.09983633387889%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACo0lEQVQoz1WSXUhTYRjHJyIr2xBhyMCbMCfUSitF14V4oWBeSAwsgvBidzovLLrprsvQqwnRB3URoc2EGqarNe3s0OY8uraxue+PZM61763tzJ325el5RgY+8HJ+73ve83//z/89nAaotra2Bg6UQqFoHhoaunxzdLTj3YqK23XleufF7l7x3MKLMyLx1fOdl3p6Ju7JeGPSu63Iw2O3Wu8/eszr7rshHhgcbp+4faeu8798Pt/LUqnE5vP50DeC0FAmC/19i2LW1Z+R9427lupH1apux2QObZusVY12cxtebZMGqmKkTJHJycleDhjsEAqFF0CPm0ql3rBQtVot5/V6DcgFmmZdLpehWq1mcW6320yl0p/fyAehkMNqsTgy6TRL0/mj2dnZfjQmaWlpkcCzPRqNLuJG+Djvdru32H+FnMlk6iJ7e3s/YrFYDjkYDDoDgYATDLDpdLo4NTXVX3coEAhEIHgWNi4cHx9XoG2fw+FYLZfLSRhZZIZhPGgY3H61Wq1ej8dTgIN0ZrNZBxM6Fo0GZ2Zmrp3KkCTJB/ABabPZlGtra0/sdvs6jC/IsLYEIptqtXrOaDQuudzuDYNB/+ztovKpal2j/aTWrIyPj4s4jY2N50ZGRngoGA6Hl7EVcMg4nc6dk5aRYe0IGUSpbDZbQE7E4wc6HRn4uR9i/YFgZXp6egB1Bvl8/iBmGI/HX+PGSqUSh3YIyKYKEWCGBKxF8R38CUQul/tVF0wknB6P21oo0CzDFNPQch+nqamJK5VKm1E5mUwqcSOIlOCWTScOkUGcQYZL2KVpuogMf0UYIgpCzizkX5PL5ZJTGUJOD8Gl4fDwcEWv189HIhENjA1kWHsPB5KQ37zf718GJiCKV1qt9jlFUQQc+kEmk3X9BYHqF7qoGS41AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="progressive rendering"
        title=""
        src="/blog/static/progressive-rendering-e58351df6b94ecd408d64131f9282fe2-a5e4a.png"
        srcset="/blog/static/progressive-rendering-e58351df6b94ecd408d64131f9282fe2-b200a.png 213w,
/blog/static/progressive-rendering-e58351df6b94ecd408d64131f9282fe2-d4624.png 425w,
/blog/static/progressive-rendering-e58351df6b94ecd408d64131f9282fe2-a5e4a.png 611w"
        sizes="(max-width: 611px) 100vw, 611px"
      />
    </span>
  </span>
  
  </a>
    </p>
<h2 id="构建dom"><a href="#%E6%9E%84%E5%BB%BAdom" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>构建DOM</h2>
<p><em>DOM (Document Object Model)</em>，文档对象模型，构建DOM是必不可少的一环，浏览器从发出请求开始到得到HTML文件后，第一件事就是解析HTML成许多Tokens，再将Tokens转换成object，最后将object组合成一颗DOM树</p>
<p>这个过程是一个循序渐进的过程，我们假设HTML文件很大，一个<em>RTT (Round-Trip Time)</em>只能得到一部分，浏览器得到这部分之后就会开始构建DOM，并不会等到整个文档就位才开始渲染。这样做可以加快构建过程，而且由于自顶向下构建，因此后面构建的不会对前面的造成影响</p>
<p>后面我们将会提到，CSSOM则必须等到所有字节收到才开始构建</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/full-process-ad6ebc3fa910f6637ef3239119e59e19-f06f1.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 55.38735529830811%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAADTUlEQVQoz2NgmhPcyDDdbwXDZJ/FDAuC5/Fl2+uJMbBJiMhIyggKCSmIiYlLqalr8IOwhqYWn5KyioCWtg4viK2qps6vqaXNp6ikLGhqZsH9//9/Rob+Q7squvdunde+bf3cicf2TamYM1WFgYGBy9HBWsDCRI/PSFeD38PFjtvZ3pLHzcGS28vFhtvV3pIbxPZwtuEO8nbmPLtnOcvW5VNZVi+dycxw8cbLkiOnb8/cvu/MzKt33vUtWL5FNyQiVCUqIU05IS1LMSYxUTMwLFY5MiZGPSIuUd0/NFo9PDpKKzA8Ti08OkYjKT1TZcexS4L7jx0SPXHmPDfDrsufKrdfeDd//bHH8/de/967dN+DhDm7npevOPo2e+Geh+Vz97zOP3ztc/6KY99TFu6+V7vmxPviGdue5q099qxm3r4PmXN3PipZBRRbceJ33slbf9wYXp0vL390vHDu9X05c95fKuu/cLDd6uqB8t5zh3ocz+xrCbi4t6xl34lTElcOVNaf3tMQfPzADKPL+8u79u6er3HnRF3pzWMNqRePTXK4fqhi7q2T3VYMb04lVz4/Gj//zp7YeR/PJk25uidf887x2oALh3plrh9tVbt7vDJg3dZ9bHeOV/vcO15pf+tIpcmto1Wxh/bMErx7ss7p7slG88tHOpRuHKkJPbW/R4Lh4/n0mnenkxc9OZww79ul9Nl39qfJAyOF4c6+DO4ru3P4Qexpyw+wgeiz+5vybxwuX8WAD6gaRTIe2TmL8f//24yWLkmM/0/qMO49uIzzyqHqwhuHy+Yt3bBUjcHkIFP3ikPcFw825t88UtYu3PCflYHhP+ODU9W8b87nsYPMeXY6nfHxuRiEwXlhQCX/IexbR8qqQQbeOtHgdu9E9ZJdR05r3D3ZMPHm8dqmhPn/eRZsOCc9f88z0ZtHq1Y8OFWZDdLz/VIy44kD0xgYnhxJY3h1MpXh5cl0hlfHY8EGXjtQxProbC/Y5ou3nkefvPp6/plTm4qv7CtccebCuZpDZx8vOXfzucndo3l9t49Xp4LUfTobx3jmUB9mELzfrQ9nz2n1hoj9/8916vLjhcfP3th2/OKjCmCOYAKJ3zjRzbx7fSUj2BG7k4DkfwYAkmqPY+PyWEUAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="full process"
        title=""
        src="/blog/static/full-process-ad6ebc3fa910f6637ef3239119e59e19-8d63b.png"
        srcset="/blog/static/full-process-ad6ebc3fa910f6637ef3239119e59e19-16ce1.png 213w,
/blog/static/full-process-ad6ebc3fa910f6637ef3239119e59e19-898e7.png 425w,
/blog/static/full-process-ad6ebc3fa910f6637ef3239119e59e19-8d63b.png 850w,
/blog/static/full-process-ad6ebc3fa910f6637ef3239119e59e19-f06f1.png 1123w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<h2 id="构建cssom"><a href="#%E6%9E%84%E5%BB%BAcssom" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>构建CSSOM</h2>
<p><em>CSSOM (CSS Object Model)</em>，CSS对象模型，构建过程类似DOM，当HTML解析中遇到<code class="language-text">&lt;link&gt;</code>标签时，会请求对应的CSS文件，当CSS文件就位时，便开始解析它（如果遇到行内<code class="language-text">&lt;style&gt;</code>时则直接解析），这一解析过程可以和构建DOM同时进行</p>
<p>假设有如下CSS代码</p>
<div class="gatsby-highlight" data-language="css">
      <pre class="language-css"><code class="language-css"><span class="token selector">body</span> <span class="token punctuation">{</span> <span class="token property">font-size</span><span class="token punctuation">:</span> 16px <span class="token punctuation">}</span>
<span class="token selector">p</span> <span class="token punctuation">{</span> <span class="token property">font-weight</span><span class="token punctuation">:</span> bold <span class="token punctuation">}</span>
<span class="token selector">span</span> <span class="token punctuation">{</span> <span class="token property">color</span><span class="token punctuation">:</span> red <span class="token punctuation">}</span>
<span class="token selector">p span</span> <span class="token punctuation">{</span> <span class="token property">display</span><span class="token punctuation">:</span> none <span class="token punctuation">}</span>
<span class="token selector">img</span> <span class="token punctuation">{</span> <span class="token property">float</span><span class="token punctuation">:</span> right <span class="token punctuation">}</span></code></pre>
      </div>
<p>构建出来的CSSOM是这样的</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/cssom-tree-341548d8f4cf8fb4d707a6ce9b8627e8-5a622.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 582px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 51.37457044673539%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAACrElEQVQoz41SXUhTARS+booQ4UvZS9BDP1BQ0EMEQUHUS2FED4GRD4mkLKNRkssphT9kiYtS8KHQoh/oJSqNWTqVdd3mdbt/2737u7t3273uz825ueZw8+e0zepFH/rgwDmHw3fOd85BkDxIbvEWwfieUw6ph2B9Gto1N/QVh2OemZbTQUvTsGi6PRYg2jr1EwPlAAgCUF6C/AEk98siWH2pH2+XX3qysJm08fEJFy8BbuXSs5TbjdmCM+pxOPFFO3QhgClxVqcQveb290gllP8lOqSGUmQ7kHZJphndKJ3JwA4AkOetRMRbqgRM3Uugva1a/eieQt2ZbjhAor1Kj1H1CEdf1Ff3r1SO6j6epdHuN7yxeVAkumqbP6yVbWlw8qamIkyqyCVKkUxY70Voo+ZiIe/Eus7NWxQBYarmV5JW0AOD93dGyLuXo5aGORGtXYxSytdFApMjdYVwhNQmJtqixaI900zi8VsDHJ+efFaj1/W99M22NeBTrXtHLHB4Eg91fMd8AwZbrGnMsnDtJ5O5qqcT/eNksh93JjoMzMJ1hPGEjdnsCgSCIQhHIrCaywLBxTpjROM3aboOYoQSGFRVzfhX2/LrAEHwQnYlAywfWfJIcSyXzYAk+mF1bR1YIW5AzM64ysGHDDjj+4RZxfYxI1ffNw67CtMrB9CD++5IFQXfwi1XCVKMIu3iZ8wmPpywpqus3nQj54+N5BU+RalgtZnPHd2yw2E77LZ745N2bk5nsYenKGfwh0sImRhv6gHyP7B7gjLWRspIq7N4IVpYPrVRkMZzIPoFCIUCBaUghVNo8e/AVobTTrk3sCiTIilZUPLJPW6HzMV55WZ3WvaPmOKXioHeljriDyXnWacQp1leIFlBy3Dhd7SQvrFJOF9S9yqHnO9e33bA37RPvRr/HVl2AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="cssom tree"
        title=""
        src="/blog/static/cssom-tree-341548d8f4cf8fb4d707a6ce9b8627e8-5a622.png"
        srcset="/blog/static/cssom-tree-341548d8f4cf8fb4d707a6ce9b8627e8-f1daf.png 213w,
/blog/static/cssom-tree-341548d8f4cf8fb4d707a6ce9b8627e8-a4e18.png 425w,
/blog/static/cssom-tree-341548d8f4cf8fb4d707a6ce9b8627e8-5a622.png 582w"
        sizes="(max-width: 582px) 100vw, 582px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>需要注意的是，上面并不是一颗完整的CSSOM树，文档有一些默认的CSS样式，称作<em>user agent styles</em>，上面只展示了我们覆盖的部分</p>
<p>CSSOM的构建必须要获得一份完整的CSS文件，而不像DOM的构建是一个循序渐进的过程。因为我们知道，CSS文件中包含大量的样式，后面的样式会覆盖前面的样式，如果我们提前就构建CSSOM，可能会得到错误的结果</p>
<h2 id="构建render-tree"><a href="#%E6%9E%84%E5%BB%BArender-tree" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>构建Render Tree</h2>
<p>这也是关键的一步，浏览器使用DOM和CSSOM构建出Render Tree。此时不像构建DOM一样把所有节点构建出来，浏览器只构建需要在屏幕上显示的部分，因此像<code class="language-text">&lt;head&gt;</code>,<code class="language-text">&lt;meta&gt;</code>这些标签就无需构建了。同时，对于<code class="language-text">display: none</code>的元素，也无需构建</p>
<blockquote>
<p><code class="language-text">display: none</code>告诉浏览器这个元素无需出现在Render Tree中，但是<code class="language-text">visibility: hidden</code>只是隐藏了这个元素，但是元素还占空间，会影响到后面的<strong>Layout</strong>，因此仍然需要出现在Render Tree中</p>
</blockquote>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/render-tree-construction-0c389301ba794f3ca7b491572d73971d-c2ada.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 46.69565217391305%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACkUlEQVQoz3VQXUhTYRg+001tztLSwixoppSplDdelBQEsatuwwwUE6YozAqdM1D8I0mtTApTFywbiznNLFEcOrdz9uPOjmc7PztnZ39u07RA6yqii/jaWVHe9MAHz/N+Dw/v+0BQHAC4BVkHU3Jyz1xO5zVu6ZX5rO0T3PqzhP7tAYKKK9dOV966fYrXu2hNKojeT4H24wdIOCEGbm9jbN0K6C5I5ufI8uNKerVlfHxGGw8ECa+L3Sslue0pgo0NG+zfyiizUkmYOxR5w0CkGJwQbTrlkoTRh6juUGZVtxfpGCRsIwrW+aQm5Ggb085O5T6dB8dsFrUsaFfqvdgrqRn/cvwdEivkHN1qn1VZu2p8fpW09BgQWCcj4D4d4dRcgkJIczrQQAI3w+a56M2XTg/Z7lntnHOg8AOE2Bum1meqA5b6IdqLXcfIoNdFbqy50ekBEu7ReP3Rt5jHSxD+T2o3ydpRcmPxz/Gtgt14Rzyzu6N1iIt7bXayjfvraenXp1mxQMkyGj2P06EVxzpDod6dnvIGTjhv8WW+hyN5k/oFMdR6ryGpqbE+taS4KDM/X3r4YvmFND5A88acYYSJE7oP2JGFJeshF+Y+Fx8n8X8vpqmjI2pDZpwmF0glwsKTEmGcC8pKC4T7l8iIvyyR+IBwfgeI6dDnUSb4cdZBblUTvrAsEt1SU7GfUspULQGROjH0P1RVVUFyufyvXqTDBSs47FlCTYTWFr0ZRnu7IliXTrsSySkaBaLwmkobQ9se5ZtAsoVjs5doLnvShCc27+wf+Bd8o7Y20eEc7hevBYkKI02fpQI7Q24mOob7tvtcZFCP+r8XbzqaHkbszSojE1SYcDNjIp0GfPcrfx1kDbDQL+2RTlz0GRJmAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="render tree construction"
        title=""
        src="/blog/static/render-tree-construction-0c389301ba794f3ca7b491572d73971d-8d63b.png"
        srcset="/blog/static/render-tree-construction-0c389301ba794f3ca7b491572d73971d-16ce1.png 213w,
/blog/static/render-tree-construction-0c389301ba794f3ca7b491572d73971d-898e7.png 425w,
/blog/static/render-tree-construction-0c389301ba794f3ca7b491572d73971d-8d63b.png 850w,
/blog/static/render-tree-construction-0c389301ba794f3ca7b491572d73971d-c2ada.png 1150w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>构建过程遵循以下步骤</p>
<ol>
<li>浏览器从DOM树开始，遍历每一个“可见”节点</li>
<li>对于每一个"可见"节点，在CSSOM上找到匹配的样式并应用</li>
<li>生成Render Tree</li>
</ol>
<h3 id="扩展：css匹配规则为何从右向左"><a href="#%E6%89%A9%E5%B1%95%EF%BC%9Acss%E5%8C%B9%E9%85%8D%E8%A7%84%E5%88%99%E4%B8%BA%E4%BD%95%E4%BB%8E%E5%8F%B3%E5%90%91%E5%B7%A6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>扩展：CSS匹配规则为何从右向左</h3>
<p>相信大多数初学者都会认为CSS匹配是左向右的，其实恰恰相反。学习了CRP，也就不难理解为什么了。</p>
<p>CSS匹配就发生在Render Tree构建时（Chrome Dev Tools里叫做<em>Recalculate Style</em>），此时浏览器构建出了DOM，而且拿到了CSS样式，此时要做的就是把样式跟DOM上的节点对应上，浏览器为了提高性能需要做的就是快速匹配</p>
<p>首先要明确一点，浏览器此时是给一个"可见"节点找对应的规则，这和jQuery选择器不同，后者是使用一个规则去找对应的节点，这样从左到右或许更快。但是对于前者，由于CSS的庞大，一个CSS文件中或许有上千条规则，而且对于当前节点来说，大多数规则是匹配不上的，到此为止，稍微想一下就知道，如果从右开始匹配（也是从更精确的位置开始），能更快排除不合适的大部分节点，而如果从左开始，只有深入了才会发现匹配失败，如果大部分规则层级都比较深，就比较浪费资源了</p>
<p>除了上面这点，我们前面还提到DOM构建是"循序渐进的"，而且DOM不阻塞Render Tree构建（只有CSSOM阻塞），这样也是为了能让页面更早有元素呈现。考虑如下情况，如果我们此时构建的只是部分DOM，而此时CSSOM构建完成，浏览器此时需要构建Render Tree，如果对每一个节点，找到一条规则进行从左向右匹配，则必须要求其子元素甚至孙子元素都在DOM上（而此时DOM未构建完成），显然会匹配失败。如果反过来，我们只需要查找该元素的父元素或祖先元素（它们肯定在当前DOM中）</p>
<h2 id="layout"><a href="#layout" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Layout</h2>
<p>我们现在为止已经得到了所有元素的自身信息，但是还不知道它们相对于Viewport的位置和大小，Layout这一过程需要计算的就是这两个信息</p>
<p>根据这两个信息，Layout输出元素的<em>Box Model</em>，关于这个，我也写过一篇文章<a href="https://tianzhich.github.io/blog/learning/2018/09/11/Document-Flow-and-the-CSS-Positioning/"><em>Understand CSS Formatting Model</em></a></p>
<p>目前为止，现在我们已经拿到了元素相对于Viewport的详细信息，所有的值都已经计算为相对Viewport的精确像素大小和位置，就差显示了</p>
<h2 id="paint"><a href="#paint" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Paint</h2>
<p>浏览器将每一个节点以像素显示在屏幕上，最终我们看到页面</p>
<p>这一过程需要的时间与文档大小，CSS应用样式的多少以及复杂度，还有设备自身都有关，例如对简单的颜色进行Paint是简单的，但是<code class="language-text">box-shadow</code>进行paint则是复杂的</p>
<h2 id="引入javascript"><a href="#%E5%BC%95%E5%85%A5javascript" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>引入JavaScript</h2>
<p>前面的过程都没有提到JavaScript，但在如今，JavaScript却是网页中不可缺的一部分。这里对它如何影响CRP做一个概要，具体细节我后面使用Chrome Dev Tools进行了测验</p>
<ol>
<li>解析HTML构建DOM时，遇到JavaScript会被阻塞</li>
<li>JavaScript执行会被CSSOM构建阻塞，也就是说，JavaScript必须等到CSS解析完成后才会执行（这只针对在头部放置<code class="language-text">&lt;style&gt;</code>和<code class="language-text">&lt;link&gt;</code>的情况，如果放在尾部，浏览器刚开始会使用<em>User Agent Style</em>构建CSSOM）</li>
<li>如果使用异步脚本，脚本的网络请求优先级降低，且网络请求期间不阻塞DOM构建，直到请求完成才开始执行脚本</li>
</ol>
<h2 id="使用chrome-dev-tools检测crp"><a href="#%E4%BD%BF%E7%94%A8chrome-dev-tools%E6%A3%80%E6%B5%8Bcrp" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用Chrome Dev Tools检测CRP</h2>
<p>为了模拟真实网络情况，我把Demo部署到了我的<a href="https://tianzhich.github.io/Critical-Rendering-Path-Demo/">githubpage</a>，你也可以在仓库找到<a href="https://github.com/tianzhich/Critical-Rendering-Path-Demo">源代码</a></p>
<p><strong>同时，不要混淆DOM, CSSOM, Render Tree这三个概念，我刚开始就容易混淆DOM和Render Tree，这两个是不同的</strong></p>
<p><strong>下面的Chrome截图部分，如果不清晰，请直接点击图片查看原图</strong></p>
<h3 id="0-代码部分"><a href="#0-%E4%BB%A3%E7%A0%81%E9%83%A8%E5%88%86" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>0. 代码部分</h3>
<h4 id="html"><a href="#html" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>HTML</h4>
<div class="gatsby-highlight" data-language="html">
      <pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../css/main.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Critical Rendering Path with separate script file<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>What's up? <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>Bros. <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>My name is tianzhich<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../images/xiaoshuang.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>小爽-流星雨<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>500<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>../js/main.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script language-javascript"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
  
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre>
      </div>
<h4 id="javascript"><a href="#javascript" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JavaScript</h4>
<div class="gatsby-highlight" data-language="javascript">
      <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> span <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
span<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">'Girls. '</span><span class="token punctuation">;</span> <span class="token comment">// change DOM text content</span>
span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'inline'</span><span class="token punctuation">;</span>  <span class="token comment">// change CSSOM property</span>

<span class="token comment">// create a new element, style it, and append it to the DOM</span>
<span class="token keyword">var</span> loadTime <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
loadTime<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">'You loaded this page on: '</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
loadTime<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'blue'</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>loadTime<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
      </div>
<h4 id="css"><a href="#css" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS</h4>
<div class="gatsby-highlight" data-language="css">
      <pre class="language-css"><code class="language-css"><span class="token comment">/* // [START full] */</span>
<span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 16px
<span class="token punctuation">}</span>

<span class="token selector">p</span> <span class="token punctuation">{</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold
<span class="token punctuation">}</span>

<span class="token selector">span</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> red
<span class="token punctuation">}</span>

<span class="token selector">p span</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> none
<span class="token punctuation">}</span>

<span class="token selector">img</span> <span class="token punctuation">{</span>
  <span class="token property">float</span><span class="token punctuation">:</span> right
<span class="token punctuation">}</span>
<span class="token comment">/* // [END full] */</span></code></pre>
      </div>
<h3 id="1-不加载js情况"><a href="#1-%E4%B8%8D%E5%8A%A0%E8%BD%BDjs%E6%83%85%E5%86%B5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 不加载JS情况</h3>
<p>首先来看没有加载JS的情况</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACmElEQVQ4y5WTyW7TUBSGvUViUzWhNKoQEumWp2DVICGxg7DghTALHgVBM0ggKjopdkho7STN5NmJE89jbpJ7uHYqRAtdcKRPZ7o6Prb/SzXrn/c5jnnf6XVpnufpbrdDc50u3Wy1aZZlaZZh6GazSbdaLZrjOJrneHo0GtGSJNGiKGaQ+J0gCB8YhnlK1WrVF57vQhhF4HsehGEIjh+B7Xrguk6WZ5B+slhAFMcQE5IkIWziOI4AMIZ6vf6W+lStHYzHElaGfTRs/0DiVQ8poojGlxdIHfSRLClIUXVSk5HQ6SJVkJE+mSFVnSJN+02iaROoVCqvqAbTKCVhAEvTwEiXMRIHMP3ZBPn0CGbEe/0eWEMOxKtTaB9/hD53BKLQBGHMbrzAYnHErNaJD1y3W6ZqX09Kpu2B7QV4YnpY002YGTOYzy1wbJd8Bh9sy4UJqVm+DZqlgU4YKAOQDQnUuYK1ubJyIw++HX8vU5WjVilYAPgJYHHqYVGzQJt5aQ52sMxiw45hRpiaAVgugngJMLUimDsJGGaE3RCvMAAwbLtMHX45Kc2d9GCILS/Grh+DHy4giNBfpHU/2pDlmxiT+iqd2GpflKkGy5YM0wbP87Bt2zgIAvLDMKxWK1jfZn3NnzkZtU4DYpeXl2WK57gSQgiiKMKKqmIyGP7T0rfNBvJ8h2zYaBykWiJaWzuOsyaDbxDfyu9gSbYEIv7X1NnZ2fOACDdJFrBY3CR7UBSn218L+d+k51I7Pz9/Qx0eVp51elemLMuGLEmGqqqGrusZoiAY/eHYGI5GRtZXlI2/haIoE3L9vGq1+pLK5R/ce/xo70k+l9vP5XLF7e3t4tbWVsbOzk5xr/CwWNjdJfVN7y7y+XyxUCjc/wWNdm5DH/XtDwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="without script1"
        title=""
        src="/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-8d63b.png"
        srcset="/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-16ce1.png 213w,
/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-898e7.png 425w,
/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-8d63b.png 850w,
/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-c39de.png 1275w,
/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-12da9.png 1700w,
/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-894f8.png 2550w,
/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>上图中，浏览器收到HTML文件后，便开始解析构建DOM。</p>
<p><strong>需要注意，上图接收的只是图片的一部分</strong></p>
<p>接下来我们详细看看这三个部分</p>
<h4 id="dom构建体现为parse-html"><a href="#dom%E6%9E%84%E5%BB%BA%E4%BD%93%E7%8E%B0%E4%B8%BAparse-html" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DOM构建(体现为parse html)</h4>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/without-script2-f0e964816e3382dbc8de25141bcc6df5-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACe0lEQVQ4y5WTSW/TUBCAfUXiQmhDSMWJ9Mqv4NQgIXGDcOAPYQ78FA5JAwIKNAk0Tt00a3FSL4mTOkvrxPvyhnkvlqhAquDJn2bV2J55wzU+FHc7HeFNt9/jO50O3+v1+Ha3xx+LJ7wgCLxQr/ONRoMXRZHFKcPhkFdVlVcUhYH6a1mW39br9UdcqVh8enm5BNuxwTRNsG0LrtYOLK5WiW2D4zgM13UZnueB7/sMqlPoKZfLr7h3xf29fl8imjYKFEUNVE0LFFUNqL3RNZSjRGqBnOTIisJ06kfpjcc6Fnz/nBOEej4OfaxPSAI+IdoxEqEIroH+KNjEWE5IJcFYRL8Q21Hgyp8q+WNpBofdC3IoyqTSHEHl7BK+tg04ak9AOLegIVtwrNiYM4ODpg7VEwWE/gJq/TUcSRYRZCcaziOoVqsFbv+LmJ+vCUzNiJyrMzJQDNDNGKSJBdJAh/EyAAPjF6uY5sD0KgRF1uG0qUBNuICBZBJj7kRrbKMgnha44sdafmnaOBSXWI5PbNcHxw3A9iLw8W9cLwTHCxhUp9gUzHPZUHziOn4UY6fEZqvAfa58z0+MOZgri4RhSIEoijZc168RJyQ2ieOY9bDVwoInwo/8bG7CwvSI63msIMHZ/AdU/B7Kt4P6Xq21hL5ux7PpJF4slnS8MWbFyaj/BTpy6Ha7L7jD2tGTtmbDwmIv+ePgjcDmxPQ23XBIEsdtesmVSqXHkvRzMR5pBq6QMRqNDF3XGbJ8bpxJQ2MwGBoaxjRN+wt145/iCq6w1jMudTd9615m5+Gd1Nbu9vZ2bmtrK5dKpRiZTCb3YOd+biebZf6bSKfTuWw2e/sXqG5x/MfO0xkAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="without script2"
        title=""
        src="/blog/static/without-script2-f0e964816e3382dbc8de25141bcc6df5-8d63b.png"
        srcset="/blog/static/without-script2-f0e964816e3382dbc8de25141bcc6df5-16ce1.png 213w,
/blog/static/without-script2-f0e964816e3382dbc8de25141bcc6df5-898e7.png 425w,
/blog/static/without-script2-f0e964816e3382dbc8de25141bcc6df5-8d63b.png 850w,
/blog/static/without-script2-f0e964816e3382dbc8de25141bcc6df5-c39de.png 1275w,
/blog/static/without-script2-f0e964816e3382dbc8de25141bcc6df5-12da9.png 1700w,
/blog/static/without-script2-f0e964816e3382dbc8de25141bcc6df5-894f8.png 2550w,
/blog/static/without-script2-f0e964816e3382dbc8de25141bcc6df5-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>可以看出，浏览器解析到<code class="language-text">&lt;link&gt;</code>，<code class="language-text">&lt;img&gt;</code>等等标签时，会马上发出HTTP请求，而且解析也将继续进行，解析完成后会触发<a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/readyState">readystatechange</a>事件和<a href="https://developer.mozilla.org/en-US/docs/Web/Events/DOMContentLoaded">DOMContentLoaded</a>事件，在上图中，由于时间间隔已经到了100微秒级别，事件间隔有些许差异，但不影响我们对这一过程的理解</p>
<p>细心的话可能会注意到上图中还触发了Recalculate Style (紫色部分)，这一过程发生在CSSOM树构建完成或者发生变化需要更新Render Tree时，但是此时我们并没有拿到CSS，更没有构建出CSSOM，这一部分从何而来呢？我在下面第4部分做了分析</p>
<h4 id="页面首次出现画面"><a href="#%E9%A1%B5%E9%9D%A2%E9%A6%96%E6%AC%A1%E5%87%BA%E7%8E%B0%E7%94%BB%E9%9D%A2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>页面首次出现画面</h4>
<p>下面这一过程依次展示了CSS解析构建CSSOM，Render Tree生成，layout和paint，最终页面首次出现画面</p>
<p>下图中有一点错误：<strong>render tree构建应该发生在Recalculate Style (layout前一部分)，Layout以及后一部分Update Layer Tree作为Layout</strong></p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/without-script3-8caf62e116b5626b2ebafc051278ffa6-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACnElEQVQ4y3WTzW7TQBDHfUXiUjWhNKoQEumVp+DUICFxg3DghXAPvAQSJySUkFRC0AqIQhJSQdK0SdzE33bs+GNtx3GTHcbbBpVAV/ppZuc/O7tez3Ktg/Jup9vcPznt8d1ul+/1enznpMe32sd8s9nkm40G32q1+Ha7zfQUQRB4URT58XjMQP/VaDR63Wg0HnKVSvmJ49oQhiF4ngdBEIDjB2C5Hriuy+apFkYhRFHEmMUziOcxxHHM/NlsBpRSqFarL7l370t7g7MhVRUlkSQ5UWQ10RSNoatGosoaQ1lZSb1m1ZUe65oB1crBM+7tm1JBFBVwiU39wKWmr4Ew6cPIGsA52pTxdIAMYWQjlgBj+5zlXOlUMM8WeqDAt+aXIlc6OCwYlgNT16eG7dGRYYE20UGzJjAlHn46gUHfgP6pBrJswNgUQFD74OL1TAMCTkCoEwaLMJnDp6OjIlc9bBfCOUCUAHXJBVU1G/SJi/c4h+gCwJlGMJ1E4NkxODJuYnvgWHi3lo/3umTrkMUSAJo/fha58sdaYeIE4JGImnjCsaiCbthgOT4QzBRlLT09BHEChmnhZvg1DgEbdT+YQRAlFPMWCwrQPsaCn7/WC4pugu8TejUgHaldLpf/+Kv5Koagu1yk8U7nV5H7Xq8XAkLA9SOKvz8FrsPaZC22Bq6JWUHs1SJXq9X2CBYkxF9iH/6F7/t/WNfW8i7SnsTGfp4WfByGETbqnDXqHG2SJIx0Hs1idpI0fhNpXjrq9foLrlT+8Ojk9MyWJMmUJNGUZdlUVdXUNM3E52T2h+fmUBDMS/3/4Bodn6BfqVSecpnsnVv37+08yGYyu5lMJr+5uZnf2NhgbG1t5Xdyd/O57W2MX2o3kc1m87lc7vZvCwZtCjzzg/4AAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="without script3"
        title=""
        src="/blog/static/without-script3-8caf62e116b5626b2ebafc051278ffa6-8d63b.png"
        srcset="/blog/static/without-script3-8caf62e116b5626b2ebafc051278ffa6-16ce1.png 213w,
/blog/static/without-script3-8caf62e116b5626b2ebafc051278ffa6-898e7.png 425w,
/blog/static/without-script3-8caf62e116b5626b2ebafc051278ffa6-8d63b.png 850w,
/blog/static/without-script3-8caf62e116b5626b2ebafc051278ffa6-c39de.png 1275w,
/blog/static/without-script3-8caf62e116b5626b2ebafc051278ffa6-12da9.png 1700w,
/blog/static/without-script3-8caf62e116b5626b2ebafc051278ffa6-894f8.png 2550w,
/blog/static/without-script3-8caf62e116b5626b2ebafc051278ffa6-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>从这里我们可以看出，DOM即使构建完成，也需要等CSSOM构建完成，才能经过一个完整的CRP并呈现画面，因此为了画面尽快呈现，我们需要尽早构建出CSSOM，比如</p>
<ol>
<li>html文档中的<code class="language-text">&lt;style&gt;</code>或者<code class="language-text">&lt;link&gt;</code>标签应该放在<code class="language-text">&lt;head&gt;</code>里并尽早发现被解析（第4部分我会分析将这两个标签放在html文档后面造成的影响）</li>
<li>减少第一次请求的CSS文件大小</li>
<li>甚至可以将最重要部分的CSS Rule以<code class="language-text">&lt;style&gt;</code>标签发在<code class="language-text">&lt;head&gt;</code>里，无需网络请求</li>
</ol>
<h4 id="页面首次出现图片"><a href="#%E9%A1%B5%E9%9D%A2%E9%A6%96%E6%AC%A1%E5%87%BA%E7%8E%B0%E5%9B%BE%E7%89%87" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>页面首次出现图片</h4>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/without-script4-2ff07d9fdc2c64df19d3924874b8ab6e-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACt0lEQVQ4y52Ty27TUBCGvUVi0zZRaAQIiXTLU7BKKyGxg7DghTALFjwCrKClJQlpoVBVFDUX5SI7t9qJnTgXO3YSO77Exz7DsUnKBlgw0ifPnPk9Gs8ZU8VceodhCi/ZRoNmWZZuNOo0U2/QpXKFLhaLdKFQoEulEl0ul2mGYUINz/O0KIq0IAhrXnQ7nVf5/OUD6jiXfaQbM7AsC/S5DpZpwtywQJsbYWySOMgF2LYd4jgOLJfLkMC3CRgAcicnz6mjbDrZbrewKAqusEboumJP/B0T+v2+2+ut6V3TlyS3z3POqMlCbv/dE+ro9DDZHDSAG7cwN27ijnoFfIDSAi5g0oL+VATkI3BcG1zkgut64Ngu6d4hLLG79DwwF5C/OE9Rnw6O9gYCB9K4hyVVwSzfBEFswXCqwFAdgzTqgzwZwlgZgOZYoPSrINQ/AtfIQKd+AHx9HyvSsSddncHBm7cp6vDDl11lqIGqmXhBRjGU5zAaqGC5ALJqkuIKKIoOkjQBwwGwphPgW9+hcPYaODYDzGUG18qnnjbkoXryOUVlvl4kNaLUTQdPdRPPSVXT8WBBKho2grmFSIzCMyP4zKkOi6kNrVoFpKsOSBfv8bh26SHVgOrZaYo6Pf+2O54o5LZs7HkIIzIjn4zE971fzxVeeOaDjxCBtE+uFQcajPBMkz2ka8AybIoiu7a7mC3ANuzg5gNCw3gNXrHyV6JrnxhCyAveYev1FPUj/yNZE8sgz0a+bui+NtVIc75PdCFEF7KO/wTJo7Agyz6lcufZPWZYBUnvhZ35Yf7/rFKpPKPS6ezDerOtkoWVyaLKkiTJg8EgpNvtym2uI3McH+b+wYj8fno2m31MRaKxG/fu3rkfiUR2CInNzc3ExsZGSCwWS9yO30rEt7cTW1sRwtZfiUajiXg8fvMnl1BqSDcXvsMAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="without script4"
        title=""
        src="/blog/static/without-script4-2ff07d9fdc2c64df19d3924874b8ab6e-8d63b.png"
        srcset="/blog/static/without-script4-2ff07d9fdc2c64df19d3924874b8ab6e-16ce1.png 213w,
/blog/static/without-script4-2ff07d9fdc2c64df19d3924874b8ab6e-898e7.png 425w,
/blog/static/without-script4-2ff07d9fdc2c64df19d3924874b8ab6e-8d63b.png 850w,
/blog/static/without-script4-2ff07d9fdc2c64df19d3924874b8ab6e-c39de.png 1275w,
/blog/static/without-script4-2ff07d9fdc2c64df19d3924874b8ab6e-12da9.png 1700w,
/blog/static/without-script4-2ff07d9fdc2c64df19d3924874b8ab6e-894f8.png 2550w,
/blog/static/without-script4-2ff07d9fdc2c64df19d3924874b8ab6e-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>上图说明，浏览器接收到部分图片字节后，便开始渲染了，而不是等整张图片接收完成才开始渲染，至于渲染次数，本例中的图片大小为90KB左右，传输了6次，渲染了2次。我觉得这应该和网络拥塞程度以及图片大小等因素有关</p>
<p>还有一点需要注意，两次渲染中，只有首次渲染引发了Layout和之后的Update Layer Tree，而第二次渲染只有Update Layer Tree，我猜想对于图片来说，浏览器第一次渲染便知道了其大小，所以重新进行Layout并留出足够空间，之后的渲染只需要在该空间上进行paint即可。整张图片加载完毕之后，触发Load事件</p>
<p><strong>上图包括之后图片中的Chrome扩展脚本可以忽视</strong>，虽然使用了隐私模式做测验（避免缓存和一些扩展脚本的影响），但我发现还是有一个脚本无法去除，虽然这不影响测验结果</p>
<p>接下来我们考虑JavaScript脚本对CRP的影响</p>
<h3 id="2-引入js"><a href="#2-%E5%BC%95%E5%85%A5js" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 引入JS</h3>
<h4 id="行内script-script位于html尾部"><a href="#%E8%A1%8C%E5%86%85script-script%E4%BD%8D%E4%BA%8Ehtml%E5%B0%BE%E9%83%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>行内Script (Script位于html尾部)</h4>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/inline-script1-1c09b0e39fa9c2dba2b52eff19028a03-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACkUlEQVQ4y5WTSW/TQBSAfUXiUjWhNKoQEumVX8GpQULiBuHAH8Ic+B/tpZBGgQub2uyUNEtpNtuptzhOxh4viT2P50mDhFQOjPT5rfPsmfcs1EqF/Var8rbT64mddkfsdrviRacrNs9/irVaTaxWq2K9XhebzabYbrc5w+FQlCRJHI/HHNTfjEajd5VK5bFQKp48c1wCxHFgbttAqQtzh4K1ILBYzMFFm3oUPM8D3/c5QRBAGIZIwPXExxiDUqn0Wnh/8uFgMBgySVKWiiQvFWWyVGSFM0FdQp+MsYS1Lv/ROWM5yQ0wFwt+fCFUq+VcgG+w7AWTlAnTDBNs4nDmiONSIMiC2wTsxQ2oWzYB3VwwuvQjAAYXF+d54eiomJP6MhBVZaams6mqgaUbYJtTmM9s6F0N4Wqs4EYLTLR9xwUPi3NJPXDNKXOky0jSZnB4/CUvHB5/zkljDTTNYubMZdRnQGgEjrdG1my4tnBjwMC0PZjgRt0koKgWaNdTcMw58zQtsnUKX7818kLh0/ecMSMwnTvMJh4jNADXXyIroAlhDMRb64SGeGwPm+ZzVH0K3cs+s671CKIYGj9aeaFar+d0y8aOEmbPZszFbjMWQxRFECMbyYljHtvIpLPYZYbdxjsEaLWwID5yq9UKgjBkGt4hpRT+czGEF8QZzQvlcvkgmTEkxmLxRq7xuP2371ZWyUkajcZL4fT09KmLX5UMKB/YILwZ2pAPLPV8PtSb+G0keck6Ozt7JRQKJ086vUtLlmUjYTKZGKqqcsajkfGrPzT6g4Gxid+Goiga/n6kWCw+F1Lpe3cePth7lE6l9lOpVHZ7ezu7tbXF2dnZye5l7mczu7voX8f+RTqdzmYymbu/AbtmcG4XVYZ2AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="inline script1"
        title=""
        src="/blog/static/inline-script1-1c09b0e39fa9c2dba2b52eff19028a03-8d63b.png"
        srcset="/blog/static/inline-script1-1c09b0e39fa9c2dba2b52eff19028a03-16ce1.png 213w,
/blog/static/inline-script1-1c09b0e39fa9c2dba2b52eff19028a03-898e7.png 425w,
/blog/static/inline-script1-1c09b0e39fa9c2dba2b52eff19028a03-8d63b.png 850w,
/blog/static/inline-script1-1c09b0e39fa9c2dba2b52eff19028a03-c39de.png 1275w,
/blog/static/inline-script1-1c09b0e39fa9c2dba2b52eff19028a03-12da9.png 1700w,
/blog/static/inline-script1-1c09b0e39fa9c2dba2b52eff19028a03-894f8.png 2550w,
/blog/static/inline-script1-1c09b0e39fa9c2dba2b52eff19028a03-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>上图来看，Parse HTML这一过程被JavaScript执行打断，而且JavaScript会等待CSSOM构建完成之后再执行，执行完成之后，DOM继续构建</p>
<p>前面的例子中，我们看到DOM几乎都是在CSSOM构建完成前就构建完成了，而引入JS后，DOM构建被JS执行打断，而JS执行又必须等CSSOM构建完毕，这无疑延长了第一次CRP时间，让页面首次出现画面的时间更长</p>
<p>如果使用外部script脚本，这一时间会更长</p>
<h4 id="外部script-script位于html尾部"><a href="#%E5%A4%96%E9%83%A8script-script%E4%BD%8D%E4%BA%8Ehtml%E5%B0%BE%E9%83%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>外部Script (Script位于html尾部)</h4>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/separate-script-file1-0cc2d40af4969a48c960e6d4098be0db-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACrklEQVQ4y3WTS2/TQBDHfUXiUjWhNKoQEumVT8GpQULiBuHAF8Ic+BYcobRJ0wMSB9o0aYJKkj7yauJHsn6vH2s79g5jR0KigKWfZnZeGmv/K7Qbh7s/e633/cuBeHFxIQ4GA7F/eSW2O12x1WqJ7VZbPD8/F7vdrtjv98VerycOh0NxNpuJt7e3Oei/m06nH7D+qXB8VH9BqQ1htIJVkgJjAZiOC7pNwbZt8DwPfN/PCYIghzEGYRgCC1nuB9jDOYdGo/FW+FI72BtPplzTaRwnPHYsO57P57GiKLEkybEsK3iWYkmW1xZj0lyOFVmNFUmNVXmREarKAur1+iuh0/1RUWUJRsNLrmkqd10LlkQGFnngMYq4ufUD9JEAsXwTJtpNzphcc7QJcRU4bTarwvHnWkWdyzAZTbgqSZyoC9AWSzCWBDSLAg0Y+NQD11gC1We5T3UNdIOAbRlg6ITbjpl4jglfa/tV4ejjp4rrp0AZcM1wuU0j8EIAx/TAdBMIVgCBtwLXZ2A5Rn72iYkbp0A0CurCynoSjvF2o1EV6vvHFX2pg62Z3DGsDPDwQlzE8XA4w2GmDYqkwGw6A9OwwTfMdR59Wzc5tZwkYRF0T/GXv31vV+QFAYc6PMWrStIE0K5JU7RIFEHs0ZzE94An6xoOkIEeJOhCr9+vCmdnzYrnupkseMgYz2TwFyiREIdmsDC6m8968oHdTqcqnJyc7Lk4EEkdx/kDSulv7ubu1K0yXaKwX2cDn/t+AFG2AQYzG8dxTnYOWJhvksX/R1aXfc1m841wcFh7Nri6NlDMZD6fEUmSCIqaqKpK8DmRm9GEjMZjss7/G+xZ4BOkKOyXQqH44N7jRztPioXCbqFQKG9ubpY3NjZytra2yjulh+XS9jbG17n/USwWy6VS6f4vT4puyFGkYREAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="separate script file1"
        title=""
        src="/blog/static/separate-script-file1-0cc2d40af4969a48c960e6d4098be0db-8d63b.png"
        srcset="/blog/static/separate-script-file1-0cc2d40af4969a48c960e6d4098be0db-16ce1.png 213w,
/blog/static/separate-script-file1-0cc2d40af4969a48c960e6d4098be0db-898e7.png 425w,
/blog/static/separate-script-file1-0cc2d40af4969a48c960e6d4098be0db-8d63b.png 850w,
/blog/static/separate-script-file1-0cc2d40af4969a48c960e6d4098be0db-c39de.png 1275w,
/blog/static/separate-script-file1-0cc2d40af4969a48c960e6d4098be0db-12da9.png 1700w,
/blog/static/separate-script-file1-0cc2d40af4969a48c960e6d4098be0db-894f8.png 2550w,
/blog/static/separate-script-file1-0cc2d40af4969a48c960e6d4098be0db-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>对于网络请求的资源，浏览器会为其分配优先级，优先级越高的资源响应速度更快，时间更短，在这个例子中，CSS的优先级最高，其次是JS，优先级最低的是图片</p>
<p>我们主要来看第一部分，后面部分和第1个研究类似</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/separate-script-file2-09073a1ad225a4acef44ad67fd673a85-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACkklEQVQ4y5WTS2/TQBCAfUXiUjWhNKoQEumVX8GpQULiBuHAH8Ic+CNcSh2FUx+oTdIoFc2jtE0cv+PE9Wv9jL3DrEMrQPTASp9mxzM7npmd5U6be9vn/c7H4cWIHw4G/Gg04gfDC/602+M7nU5Bt9vle70eP0B7v9/nr66ueEmS+Ol0WoD7D6IofkLf51yzIbzyfRd8EoBtO+D7HtgeAcv1wHVdIIRAEAQQhoywII4jiJMY5YooioBSCs1m8z23K+ztTCYTKopqKit6qioaoqbSVE5FUUoV1BmSpBRSltViv0K+JcYzIAjCG67dOqklMf41iqksSXQ8vgTD0MA0dZAVEXRdhfncAMexQNPkAtMwUTcgiH0IE0KRLM0TOPp2WOc+C/u1iWaD64d0trCoNjNhbt2A47ngYalzm7WDQIil+ah72BqCZZMoxNbYMFVtOrO8LMlz2D84qnO7X09qzsKHwIspQUI/AXPhgWzcIA5IMw+DBqCjz8zCfpIUAvQJyRLcmQWGlVIvgiwFgE73rM4JzcOatbDBcQm1HZ+iZNmC7QZwg8wdgtkGd/gkwouKUMZA0C+IUkqiZbbMAXpn3+vcwVG7pmJP8EYpW1mWFTd2C/y2Z+RYWk7zX7LQKc3zDBOEfv+8zrXbrRrxfTYaFEeAshH4T/BMXATEWa1zx8fHOz4GRHLM8g88z7vjb9tffks2jzjYb1nAl0EQQpIkxZAymaZpAdPDaDW47Pt9MD+2Wq3WO+7LnvBiePHDkmXZlGXJVBTF1DTN1HXdxOdkXl5PzOvx2FzZ/w2eMfAJeo1G4zVXKj968PTJ1rNyqbRdKpWq6+vr1bW1tYKNjY3qVuVxtbK5id9Xtvsol8vVSqXy8CcW3W+pIzih7gAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="separate script file2"
        title=""
        src="/blog/static/separate-script-file2-09073a1ad225a4acef44ad67fd673a85-8d63b.png"
        srcset="/blog/static/separate-script-file2-09073a1ad225a4acef44ad67fd673a85-16ce1.png 213w,
/blog/static/separate-script-file2-09073a1ad225a4acef44ad67fd673a85-898e7.png 425w,
/blog/static/separate-script-file2-09073a1ad225a4acef44ad67fd673a85-8d63b.png 850w,
/blog/static/separate-script-file2-09073a1ad225a4acef44ad67fd673a85-c39de.png 1275w,
/blog/static/separate-script-file2-09073a1ad225a4acef44ad67fd673a85-12da9.png 1700w,
/blog/static/separate-script-file2-09073a1ad225a4acef44ad67fd673a85-894f8.png 2550w,
/blog/static/separate-script-file2-09073a1ad225a4acef44ad67fd673a85-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>可以看到，增加了对JS文件的网络请求时间，一轮CRP时间更长了，对比上面的行内Script可能时间差异没有那么明显，是因为这个例子中的JS文件体积小，传输时间只比CSS多一点，主要决定JS何时执行的还是CSS，如果JS稍大，由于请求优先级低于CSS，则差异会明显变大</p>
<h3 id="3-async-script"><a href="#3-async-script" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Async Script</h3>
<p>如果Script会对页面首次渲染造成这么大的影响，有没有什么好的办法解决它呢？</p>
<p>答案是肯定的，就是使用异步脚本<code class="language-text">&lt;script src=&quot;&quot; async /&gt;</code></p>
<p>使用异步脚本，其实就是告诉浏览器几件事</p>
<ol>
<li>无需阻塞DOM，在对Script执行网络请求期间可以继续构建DOM，直到拿到Script之后再去执行</li>
<li>将该Script的网络请求优先级降低，延长响应时间</li>
</ol>
<p>需要注意如下几点</p>
<ol>
<li>异步脚本是网络请求期间不阻塞DOM，拿到脚本之后马上执行，执行时还是会阻塞DOM，但是由于响应时间被延长，此时往往DOM已经构建完毕（下面的测验图片将会看到，CSSOM也已经构建完毕而且页面很快就发生第一次渲染），异步脚本的执行发生在第一次渲染之后</li>
<li>只有外部脚本可以使用<code class="language-text">async</code>关键字变成异步，而且注意其与延迟脚本 (<code class="language-text">&lt;script defer&gt;</code>)的区别，后者是在Document被解析完毕而DOMContentLoaded事件触发之前执行，前者则是在下载完毕后执行</li>
<li>对于使用<code class="language-text">document.createElement</code>创建的<code class="language-text">&lt;script&gt;</code>，默认就是异步脚本</li>
</ol>
<p>直接看图</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/async-script1-e2672a947b0e181cdb84773dc873fd91-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACrElEQVQ4y5WTSW/TQBTHfUXiQNW0JRVISKRXPgWnBgmJG4QDXwhz4HPQA2pLm96AUqI0hRRna5Y63u3ENt4Sx3Hmz3NYhQSIZ/301nkezbzhauX9rUbj9Fmz3ebbrRbf6XT4RrPNnwsNXhAE/qx2tuTjhw98s9nkB4MBL0kSPxwOf+WpKIrPq9XqHa5cPrjv+S6iKEIYBphOJ/CCCI4XIPB9ioWUC5f5yWSCaTxFHMc/yPxsDaOvfHT0hNs9KG/3eiJTFC1RVD2RSUuSQqiJJGuJphmJrlmJrpqJqY9IG0tbI60pX20i1lQN+3t7D7lK9bRouhHafYmdnjfZebuH9uUQkmlDNsdQRxcQxHP0TAHC8BRd0v1RA12DYsSFXmd981M6xwzvq7USt/PioKgNFBiqwi76AyZKMszRGCPbhmuaUC97MMQO5LGMS62HXrcORe9CczUYvgHV1Zjuqmmgd/B6d6fEvdx7WzSUERw7YG6YMtuLYdoRZN2BqliwDAe26cL1EoQTBrEjwnPoLBPAdmM4/pw59iQNFA2V129K3O7Ru6Ksj6EbFjNHDtPNEWzHg/05IOgyZinCmKAOwWSGIJ6TP4cfxfSTkC4vZK4fpdMUqNU/lbjj4wo1tGHZIfPCOZFQ8RzzdAHGFkjpdNI0XbL4xg97schgJNQOEARqeHZWK47HNjw/ZAxgVIOM/xBahmXDVqtV4iqVyvZn181mbjGL40X8nen0p/1v5rRL1Ov1R9zJycm9aDLFbDajAf06tJn93Y9omLOB/nWYfyery4Q295jbf3Vwt9W5sCVZtmRCVVVL1/UlQ1G0uv1Lqz8YLHN/QlEUg56ff3h4+IDL5dav3Lp543Yul9siCqurq4WVlRXiWmF9Y6NwY/N6YTOfX8b/xtraWiGfz1/9AgBebBrIQTHSAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="async script1"
        title=""
        src="/blog/static/async-script1-e2672a947b0e181cdb84773dc873fd91-8d63b.png"
        srcset="/blog/static/async-script1-e2672a947b0e181cdb84773dc873fd91-16ce1.png 213w,
/blog/static/async-script1-e2672a947b0e181cdb84773dc873fd91-898e7.png 425w,
/blog/static/async-script1-e2672a947b0e181cdb84773dc873fd91-8d63b.png 850w,
/blog/static/async-script1-e2672a947b0e181cdb84773dc873fd91-c39de.png 1275w,
/blog/static/async-script1-e2672a947b0e181cdb84773dc873fd91-12da9.png 1700w,
/blog/static/async-script1-e2672a947b0e181cdb84773dc873fd91-894f8.png 2550w,
/blog/static/async-script1-e2672a947b0e181cdb84773dc873fd91-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/async-script2-9e74f3cd580f15b1970472835b12101f-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACx0lEQVQ4y32STW8SURSGZ2vipilYJcaYiFt/hSsxMXGndeEfcly4cmP8BWo0toLWalMt1BakAgOY4jAfgMDwMd9zmbmvZ6a1RqPe5MnJec/NmXPmvkL59frlemP/vtRqic1mU2xRrEtN8aBWF+v1ulgulxM+Vz6LjUZD7HQ6oqIoYrfbPYHye7IsP9jb27si5PPrN6YzA47jwLZteJ6LmeVgMrdgmmaiO64Ll/A8D77vIwiC34g1gKNQKNwVnrx4ca3dbHJd1ZiaoBIK0yhq2lGuaeqxrjKa5iQqdI8mZF256+u9ftzwllAs7uRc+jILGfeZx9ligUUIyjkYC4kIQUwQ/iLJIywWHHPL5fZ0FCIK8KVeWxXyhc2cLksYjHTeM8Zcae/gsPoMqrSG7/ImvnffYKy9xVh/R2xhpG6QnofRi7UNTLQ3XGtLoTHSsf1ha1V4vbmb05Qe5mbAHR98OlAw0GuYDCSMJgqk5jYOio9R332E1qeHaFef4ltrAwell6h9WoNUfc9n/VEYehzlajzhZjHXH1uY0ujzucXNyRweAxy6YDshLDOEqoyxt/MRxa0C5I4Oc+JDq9D05ecYtSXuTs0wol9UOaCG2x9KOaU3ppVNPrMCPjHmmBkzMNtC5NqIPBsIXCzolZnrgQceQtdCYM8ROCYC0+DBhP4hnVqNGlYq+7mxYdDKNuf09hEVYv53wiiCaVmwyGamaXHHspKG5ONVoVTavTabTmk1MwoCP/J97wgvjv4vvCPNO9YZPT+jp04iY4u4YbVavU22KV53aJXYoH8aN85/mjrW/0Z8J67Hp1Qq3RHW1l9dbbTahqKqQzLsUNf1Yb/fT+jK8vDr4bfhYaeT1MjoJ/Enx/mAjG7m8/mbQip95tTFC+cvpVOpy6lUKru8vJxdWlpKWFlZyZ7PnM1mzp0j/aj2L9LpdDaTyZz+ARbmZ7KZk4J/AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="async script2"
        title=""
        src="/blog/static/async-script2-9e74f3cd580f15b1970472835b12101f-8d63b.png"
        srcset="/blog/static/async-script2-9e74f3cd580f15b1970472835b12101f-16ce1.png 213w,
/blog/static/async-script2-9e74f3cd580f15b1970472835b12101f-898e7.png 425w,
/blog/static/async-script2-9e74f3cd580f15b1970472835b12101f-8d63b.png 850w,
/blog/static/async-script2-9e74f3cd580f15b1970472835b12101f-c39de.png 1275w,
/blog/static/async-script2-9e74f3cd580f15b1970472835b12101f-12da9.png 1700w,
/blog/static/async-script2-9e74f3cd580f15b1970472835b12101f-894f8.png 2550w,
/blog/static/async-script2-9e74f3cd580f15b1970472835b12101f-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>由于Script执行修改了DOM和CSSOM，因此重新经过Recalculate Style生成Render Tree，重新计算Layout，重新Paint，最终呈现页面。由于这一过程仍然很快（只用了140ms左右），因此我们还是察觉不到这个变化</p>
<h3 id="4-css在html中不同位置的影响"><a href="#4-css%E5%9C%A8html%E4%B8%AD%E4%B8%8D%E5%90%8C%E4%BD%8D%E7%BD%AE%E7%9A%84%E5%BD%B1%E5%93%8D" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. CSS在HTML中不同位置的影响</h3>
<p>前面留下了一个问题，CSSOM没有构建完成，为什么刚开始的Parse HTML同时就有Recalculate Style这部分？或许这部分会给你一个答案</p>
<p>这里为了避免JS带来的影响，使对比更有针对性，删除了JavaScript</p>
<h4 id="设置style在html文件头部"><a href="#%E8%AE%BE%E7%BD%AEstyle%E5%9C%A8html%E6%96%87%E4%BB%B6%E5%A4%B4%E9%83%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>设置style在html文件头部</h4>
<p>先来回顾一下在头部设置<code class="language-text">&lt;link&gt;</code></p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACmElEQVQ4y5WTyW7TUBSGvUViUzWhNKoQEumWp2DVICGxg7DghTALHgVBM0ggKjopdkho7STN5NmJE89jbpJ7uHYqRAtdcKRPZ7o6Prb/SzXrn/c5jnnf6XVpnufpbrdDc50u3Wy1aZZlaZZh6GazSbdaLZrjOJrneHo0GtGSJNGiKGaQ+J0gCB8YhnlK1WrVF57vQhhF4HsehGEIjh+B7Xrguk6WZ5B+slhAFMcQE5IkIWziOI4AMIZ6vf6W+lStHYzHElaGfTRs/0DiVQ8poojGlxdIHfSRLClIUXVSk5HQ6SJVkJE+mSFVnSJN+02iaROoVCqvqAbTKCVhAEvTwEiXMRIHMP3ZBPn0CGbEe/0eWEMOxKtTaB9/hD53BKLQBGHMbrzAYnHErNaJD1y3W6ZqX09Kpu2B7QV4YnpY002YGTOYzy1wbJd8Bh9sy4UJqVm+DZqlgU4YKAOQDQnUuYK1ubJyIw++HX8vU5WjVilYAPgJYHHqYVGzQJt5aQ52sMxiw45hRpiaAVgugngJMLUimDsJGGaE3RCvMAAwbLtMHX45Kc2d9GCILS/Grh+DHy4giNBfpHU/2pDlmxiT+iqd2GpflKkGy5YM0wbP87Bt2zgIAvLDMKxWK1jfZn3NnzkZtU4DYpeXl2WK57gSQgiiKMKKqmIyGP7T0rfNBvJ8h2zYaBykWiJaWzuOsyaDbxDfyu9gSbYEIv7X1NnZ2fOACDdJFrBY3CR7UBSn218L+d+k51I7Pz9/Qx0eVp51elemLMuGLEmGqqqGrusZoiAY/eHYGI5GRtZXlI2/haIoE3L9vGq1+pLK5R/ce/xo70k+l9vP5XLF7e3t4tbWVsbOzk5xr/CwWNjdJfVN7y7y+XyxUCjc/wWNdm5DH/XtDwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="without script1"
        title=""
        src="/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-8d63b.png"
        srcset="/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-16ce1.png 213w,
/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-898e7.png 425w,
/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-8d63b.png 850w,
/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-c39de.png 1275w,
/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-12da9.png 1700w,
/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-894f8.png 2550w,
/blog/static/without-script1-781dc26a0641c9e0691481f3613ecdbf-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    
<span>link tag on top of html file</span></p>
<p>前面的DOM构建部分出现了Recalculate Style，之后获得CSS并解析后还有一次，一共出现了<strong>2次</strong></p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/without-script5-9d6eea722410e9603d15b707c9c29452-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACU0lEQVQ4y5XSW28SQRQA4H01MaHUn2D76q/wqZiY+Kb44B9yffCXmJgWrSa2SrfIRaAFSrehLGyhsOWy991Z5hzPjIW0jZc4yZczl7Mzk9mjVD7tbDYapTetdls9OTlR2xSbrbb6o1pTy+WyVKlU1Gq1qjabTanT6ai9Xk81DEOi/utut/u2VCo9UnI720/n9hw930PXdTAMApy7AU7mDtq2jb7vo09zAQnDUIqiCOM4lkRfAETc3d19pbx7v72ln3Whb5rMMHrM6PUYncj6/T4xr8f9W9Gg2DWMVT6JTPMCc7ncc+VQ0zIsjmh/cQgH5AkugbBgyK/BnYhciIHGC7FBvV7PKvvfCpnzwRRr+gjq+iUcda7w+HwqtU0X9WGApwNf0knrwsf2IMCzoYdHpxbWW2PQB8HCDREPtYOs8vFrNTPzOVp2AmObgeUkuHTlcpx4fBWFoU25LuDMY9jpTFA/ncLUh0VId8xrhazyYa+U8WPAgG7uhQvwIi766C/ReCkg84CjyBFrIQOMGAc/ggU9ElbrDbrhZy1jDsc4nc3B8wPwvID+Gvu9mGEY/RJFqz7QvHzDWo3e8HuxnJlNZxhNLKC/AAAcOf8vQOSGjcZxVikUClsO1ZsznXCqu1scx+EucW6w745tGRNRi8Vi8YWSzx88mTkuxiyRhZokiTyZriqL2KEn8Ki4GWN/JL4TTdO0l8qXvf3Hw+HlZHyjWZYljUaj8SUR8R+N0kZOPp9/pqTTqXsP1tcfrq2tbZKNVCq1kk6nN2htY52Itb8RuRTv/wSx5HL5YrXK7wAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="without script5"
        title=""
        src="/blog/static/without-script5-9d6eea722410e9603d15b707c9c29452-8d63b.png"
        srcset="/blog/static/without-script5-9d6eea722410e9603d15b707c9c29452-16ce1.png 213w,
/blog/static/without-script5-9d6eea722410e9603d15b707c9c29452-898e7.png 425w,
/blog/static/without-script5-9d6eea722410e9603d15b707c9c29452-8d63b.png 850w,
/blog/static/without-script5-9d6eea722410e9603d15b707c9c29452-c39de.png 1275w,
/blog/static/without-script5-9d6eea722410e9603d15b707c9c29452-12da9.png 1700w,
/blog/static/without-script5-9d6eea722410e9603d15b707c9c29452-894f8.png 2550w,
/blog/static/without-script5-9d6eea722410e9603d15b707c9c29452-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>再来看看改成<code class="language-text">&lt;style&gt;</code>，Recalculate Style一共出现1次</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/style-tag-top-6b7ec98c3ba3ef6280f79f6639edac1f-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACe0lEQVQ4y5WSzW7TQBDHfUVCSlMegfbKU3BqkJC4QTjwQpgDrwJKhAiipWkoidMk4MSVSvBH0iZ2E3fXXn+s7R1mHQoCiSJW+mlmPB/r3f0r/beN3fG492JyeqpOxhPVMAxVnxjqyXCkapqm9no9td/vq4PBQB2Px6qu6+p0OlVt21YtyypB/7lpmi+73e49pdl4/dC/8iFkDK58HxgL4SpgsCIUCCEYM4iiqCSO45IkSSBNU0iTtPQlcrVarWfKq0Zz7+yrJRzH4TNnxi3b4Q5a3JXP53NuWTaXOdOyNta0uP0jvraWbSfObAbNZvOxomm9WpFznC/Ehlz6IIociqIAGhKgbA0+XUHEQ4izENIshjAOgCUYp5HgWSqbYDA8qSuNVrumT10YnS2F5NPEgw+fXRh+9XAYNjIO5hkFz03AXTL0CZgLByheQZIW4HhzYZwb+UWwgMN2p640909ql0EOHsnEZcCF8S0E7ZSA7RJYExyI1+NT/FMmgCBrksM6TCFIBLAUcywVqzDKWS7g8Oi4rrw50GoRnjhKhQjjQiQZFmIsBzFsCuICGwXGBSJKX37H2k0uEQIH54U88kjHge86NefchdXaFyGLRBDiq8YpxOULcjwW/2X/9DexQFve4XA4qivdbq+2RrlEEZ4HX0M+xH8ie8qBuv6lrhwff9yjlEIQBAXq7jfwexEg9AYIKW0mtYjCfqK0j44e+DRAofJSrFmWlTsLVJAUMQ2jUvSc878i++TqdDpPlff7B/cvLhYr1/Pc6+WhL1kul+4CkfYfC8uWtN1uP1Kq1cqtO9vbd7e2tnaRnUql8pNqtbqDuZ1tROZuQtaivf0dwKdy05kDYgoAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="style tag top"
        title=""
        src="/blog/static/style-tag-top-6b7ec98c3ba3ef6280f79f6639edac1f-8d63b.png"
        srcset="/blog/static/style-tag-top-6b7ec98c3ba3ef6280f79f6639edac1f-16ce1.png 213w,
/blog/static/style-tag-top-6b7ec98c3ba3ef6280f79f6639edac1f-898e7.png 425w,
/blog/static/style-tag-top-6b7ec98c3ba3ef6280f79f6639edac1f-8d63b.png 850w,
/blog/static/style-tag-top-6b7ec98c3ba3ef6280f79f6639edac1f-c39de.png 1275w,
/blog/static/style-tag-top-6b7ec98c3ba3ef6280f79f6639edac1f-12da9.png 1700w,
/blog/static/style-tag-top-6b7ec98c3ba3ef6280f79f6639edac1f-894f8.png 2550w,
/blog/static/style-tag-top-6b7ec98c3ba3ef6280f79f6639edac1f-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    
<span><code class="language-text">&lt;style&gt;</code>在头部，一开始就直接解析完成，没有网络请求</span></p>
<h4 id="设置style或者link在尾部"><a href="#%E8%AE%BE%E7%BD%AEstyle%E6%88%96%E8%80%85link%E5%9C%A8%E5%B0%BE%E9%83%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>设置style或者link在尾部</h4>
<p>先来看看设置<code class="language-text">&lt;style&gt;</code>在尾部，Recalculate Style出现了1次</p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/style-tag-bottom-64d9c04db783659fa9b508f6dffd0916-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACT0lEQVQ4y5WS227TQBCGfYuElCZ9BNJbnoKrBgmJOwgXvBDmgjdBqI0oSLSQNDROcBslblBTJXZC4xwcn4+7M8y6NEKACoz06Z/dndn1en+p825/p99XXmqDgaz1+/L5+bnc1wZy+4sqt9ttWVEUudPpyKqqyn1a7/V68nA4lHVdl8fjcQ7lL0aj0atWq3Vfqu3vPVrbNvq+jzZpINQLcWW76DgOzQcYhmFOFEUYEnEcY5IkOSIXAAAeHBw8l16/2dsdfL2EyWSS6rqR6oZQPZ3S2KDcEPOGkedi3aBc6His5+Q9uh5Pp1Os1WpPpNbJSSVJIqQABAYiYSwjGKZpilmWkSY/NN0ogKhJkXMGLMuY6Ot2u1Xp8NPnij5b4+mFCd2LGbRUAwejNdpugF4QYZQwDOPsJ67H3yYBzs0YzYULlu+wpW9h87hVld5+VCvrgOPSY6DPbFCaF6gN52j5KfoxoJ8gKf6mtsfR8QGdgIEbcxbSNzbyDY/alYAaI7qFG2QgTl96GTohp0aOXnSN/4sGCeTrdCgQjNOV1bMebfj+uDK5muPKWoMfhOD59KJxilGc/CtA5P/w9PSsKilKu7JcWcIWkD/M/4foyTfUNK1Kr9zctSzhw4CTzzhtvEGMYyK6hTDMNeOcI5n/qVSvNx7arrcxqbCEsIwoEGZ2PHptMvuNkf+E6BPRaDSeSR8Ojx5cXc1Wi8VifhMivx6b85lpzk3iL0Flpluv1x9LxWLhznapeG9ra2uHKBcKhQ3FYrG8XSqVS4RYuw1RS3r3O/tudhAlEVmOAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="style tag bottom"
        title=""
        src="/blog/static/style-tag-bottom-64d9c04db783659fa9b508f6dffd0916-8d63b.png"
        srcset="/blog/static/style-tag-bottom-64d9c04db783659fa9b508f6dffd0916-16ce1.png 213w,
/blog/static/style-tag-bottom-64d9c04db783659fa9b508f6dffd0916-898e7.png 425w,
/blog/static/style-tag-bottom-64d9c04db783659fa9b508f6dffd0916-8d63b.png 850w,
/blog/static/style-tag-bottom-64d9c04db783659fa9b508f6dffd0916-c39de.png 1275w,
/blog/static/style-tag-bottom-64d9c04db783659fa9b508f6dffd0916-12da9.png 1700w,
/blog/static/style-tag-bottom-64d9c04db783659fa9b508f6dffd0916-894f8.png 2550w,
/blog/static/style-tag-bottom-64d9c04db783659fa9b508f6dffd0916-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p>再看设置<code class="language-text">&lt;link&gt;</code>在尾部，Recalculate Style一共出现<strong>3次</strong></p>
<p>
  <a
    class="gatsby-resp-image-link"
    href="/blog/static/link-tag-bottom-744a962b04e4da669e95f7b44481c752-332c0.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
  
  <span
    class="gatsby-resp-image-wrapper"
    style="position: relative; display: block; ; max-width: 850px; margin-left: auto; margin-right: auto;"
  >
    <span
      class="gatsby-resp-image-background-image"
      style="padding-bottom: 64.80446927374301%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABYlAAAWJQFJUiTwAAACgUlEQVQ4y3WS2W7TQBSGfYuE1Cy8AektT8FVg4TEHQ0XvBDmggepkCpKEqktJdCG1GlSKUuJCl5bO4m3sT1eYs9hZrooEu2RPv3nnzNzPOMZQWrvbY5GvY+TiwtxPB6L0+lUHE8uxP7ZUJQkSTw9PRX7/b44GAx4fTQaiZeXl6KqqqKiKDeoygdZlj/1er0XQqv59bUfIAjDEDzPhyiiGmCwPQS+z3wEGGNOHMecJEkgTdN7mGfRbrffC7t7ra3ZH5UYupYZhpFpmkZRM516XdczleZsjClHVbjSXWWyImd/ZZlpomoaNJvNt8LwTKojukP9+orImkrm9hKWnktxwPE8cOmu73Bcj47deQTqQoaZNSEzc5JfhRoc939uCzuto/poqICmmcSwLWIsLGBoFNNFECc5hDjj+EHCNcIriOIc/AjDMvTIMvLzMHRh//NOQ9g9kOq2tgBXt8jcicjSxRDSX4IwATssgK6HMAWIbgnX1PYTcFFGAkzyxMPwvb3fEJpHUp0VURAT28fEQTFtWICPC9ow53kQP0QOlo1g7gRk4YS5H2Xwqz9oCIedH3Vz6YG5DAgKIoLjhB4z5eA4vc8fIkkzBkmzVc5ueXh+3hBOjnv137IDlpcQ17EJQghugnAIoUrIvV+H1cjNBN6QvtOG8OVA2moNHZgaURH4XhEEYUHnFCyY3kHdI/B5K9aQPvptods9eXVtB5BmOf1aAeuRZSm91YQePYYiz4Gu/Y+cjq9WvB90u913wsHht5eWadqLxXxuWdZ8PZg3TZPD8segYVJFnU7njVApl56Uy5XnpVJps1wu16jWNjY2OJVKpfasWqlVq9Uaqz0GW3ObP/0HnzVyjhMdLsEAAAAASUVORK5CYII='); background-size: cover; display: block;"
    >
      <img
        class="gatsby-resp-image-image"
        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;"
        alt="link tag bottom"
        title=""
        src="/blog/static/link-tag-bottom-744a962b04e4da669e95f7b44481c752-8d63b.png"
        srcset="/blog/static/link-tag-bottom-744a962b04e4da669e95f7b44481c752-16ce1.png 213w,
/blog/static/link-tag-bottom-744a962b04e4da669e95f7b44481c752-898e7.png 425w,
/blog/static/link-tag-bottom-744a962b04e4da669e95f7b44481c752-8d63b.png 850w,
/blog/static/link-tag-bottom-744a962b04e4da669e95f7b44481c752-c39de.png 1275w,
/blog/static/link-tag-bottom-744a962b04e4da669e95f7b44481c752-12da9.png 1700w,
/blog/static/link-tag-bottom-744a962b04e4da669e95f7b44481c752-894f8.png 2550w,
/blog/static/link-tag-bottom-744a962b04e4da669e95f7b44481c752-332c0.png 2864w"
        sizes="(max-width: 850px) 100vw, 850px"
      />
    </span>
  </span>
  
  </a>
    </p>
<p><strong>先总结实验结果</strong></p>
<p>实验中将<code class="language-text">&lt;link&gt;</code>放在头部，<code class="language-text">&lt;style&gt;</code>放在头部，<code class="language-text">&lt;link&gt;</code>放在尾部，<code class="language-text">&lt;style&gt;</code>放在尾部，<em>Recalculate Style</em>的次数分别是2，1，3，1</p>
<p><strong>然后我们需要了解Chrome Dev Tools Performance Tab的几个关键过程</strong></p>
<ol>
<li>Performance Tab里的<em>Recalculate Style</em>，官方是这样解释的</li>
</ol>
<blockquote>
<p>To find out how long the CSS processing takes you can record a timeline in DevTools and look for "Recalculate Style" event: unlike DOM parsing, the timeline doesn’t show a separate "Parse CSS" entry, and instead captures parsing and CSSOM tree construction, plus the recursive calculation of computed styles under this one event.</p>
</blockquote>
<p>在Performance Tab里面，没有看到<em>Render Tree</em>构建这一过程，这一过程也被浏览器隐藏在<em>Recalculate Style</em>里面，所以<em>Recalculate Style</em>既可能包括CSSOM的构建，也可能包括<em>Render Tree</em>的构建</p>
<ol start="2">
<li>
<p>对于<code class="language-text">&lt;style&gt;</code>里的CSS，解析过程发生在<em>Recalculate Style</em>中，而<code class="language-text">&lt;link&gt;</code>获得的CSS，解析过程是单独的，叫做<em>Parse CSS</em> (和<em>Parse HTML</em>类似)</p>
</li>
<li>
<p>同时，要明确浏览器还有一个默认的<em>User Agent Style</em>，我们的Style只是对其进行一个覆盖</p>
</li>
</ol>
<p><strong>最后猜想这4个结果的原因如下</strong></p>
<ol>
<li>浏览器如果发现<code class="language-text">&lt;head&gt;</code>里存在<code class="language-text">&lt;link&gt;</code>，则会等待CSS网络请求完成并解析好之后才开始Render Tree，至于第一次的<em>Recalculate Style</em>，我猜想是默认的<em>User Agent Style</em>，此时CSSOM已经开始构建了，而接收到CSS文件，我们设置的Style会对默认的Style进行覆盖。这里第一次<em>Recalculate Style</em>只包含CSSOM构建，第二次则包含了CSSOM更新以及<em>Render Tree</em>构建</li>
<li><code class="language-text">&lt;style&gt;</code>放在头部，浏览器因为可以马上拿到CSS，就可以马上进行解析，此时<em>User Agent Style</em>的解析和我们自定义的<em>Style</em>解析合并，<em>Recalculate Style</em>包含了CSSOM构建和<em>Render Tree</em>构建</li>
<li><code class="language-text">&lt;style&gt;</code>放在尾部，和放在头部类似。只不过晚点发现CSS，但是由于是行内<code class="language-text">&lt;style&gt;</code>，还是可以马上解析</li>
<li><code class="language-text">&lt;link&gt;</code>放在尾部，浏览器一开始没发现<code class="language-text">&lt;link&gt;</code>，会使用<em>User Agent Style</em>（2次 <em>Recalculate Style</em>），后面才发CSS网络请求，最后再触发CSSOM的更新（1次 <em>Recalculate Style</em>），这是最糟糕的情况。这里的3次<em>Recalculate Style</em>分别指CSSOM构建，<em>Render Tree</em>构建，CSSOM更新和<em>Render Tree</em>构建。<em>Render Tree</em>构建两次，页面发生两次渲染，为最糟糕的情况</li>
</ol>
<p>所以，我们需要将<code class="language-text">&lt;style&gt;</code>和<code class="language-text">&lt;link&gt;</code>放在头部，对于<code class="language-text">&lt;style&gt;</code>在尾部，这个例子省略了JS的影响，如果加入JS，则结果又会不一样</p>
<p>本来想再测试一下JS在HTML中不同位置的影响，但是就CRP这一过程来讲，这部分比较容易叙述清楚</p>
<p>因为JS不管在哪个位置都会默认阻塞DOM。如果DOM尚未构建完成，JS中对不在DOM的元素进行操作，会抛出错误，脚本直接结束。如果将脚本设置为<code class="language-text">async</code>，则放在前面也是OK的，例如使用<code class="language-text">document.createElement</code>创建的<code class="language-text">&lt;script&gt;</code>，其默认使用的就是异步</p>
<h2 id="总结"><a href="#%E6%80%BB%E7%BB%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h2>
<p>这篇文章是我阅读了Google Developer的<a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/">Web Performance Fundamentals</a>后，自己做实践得到的总结。非常建议每位FEDers阅读这一系列文章。文章作者<a href="https://developers.google.com/web/resources/contributors/ilyagrigorik">Ilya Grigorik</a>还和Udacity开设了联合课程<a href="https://classroom.udacity.com/courses/ud884">Website Performance Optimization</a>以及他关于<a href="https://www.youtube.com/watch?v=PkOBnYxqj3k">Web Performance的一次演讲</a>，都值得一看</p>
<p>由于水平有限，我只看了前半部分（关于CRP），后半部分则关于在Web Performance Optimization的实践</p>
<p>疏漏之处，欢迎指正</p>
<h2 id="参考"><a href="#%E5%8F%82%E8%80%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ol>
<li><a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/">https://developers.google.com/web/fundamentals/performance/critical-rendering-path/</a> (Recommended)</li>
<li><a href="https://classroom.udacity.com/courses/ud884">Website Performance Optimization - Udacity</a></li>
<li><a href="https://stackoverflow.com/questions/5797014/why-do-browsers-match-css-selectors-from-right-to-left/">https://stackoverflow.com/questions/5797014/why-do-browsers-match-css-selectors-from-right-to-left/</a></li>
<li><a href="https://www.youtube.com/watch?v=PkOBnYxqj3k">https://www.youtube.com/watch?v=PkOBnYxqj3k</a></li>
</ol></div></article><aside class="sc-VigVT fyVvTi"><div><div class="sc-jTzLTM gUgLxq"><div class="sc-fjdhpX ljqDId"><nav><div><div class="sc-jzJRlG TWaYf">Contents<svg viewBox="0 0 926.23699 573.74994" version="1.1" width="10" height="10"><g transform="translate(904.92214,-879.1482)"><path d=" m -673.67664,1221.6502 -231.2455,-231.24803 55.6165, -55.627 c 30.5891,-30.59485 56.1806,-55.627 56.8701,-55.627 0.6894, 0 79.8637,78.60862 175.9427,174.68583 l 174.6892,174.6858 174.6892, -174.6858 c 96.079,-96.07721 175.253196,-174.68583 175.942696, -174.68583 0.6895,0 26.281,25.03215 56.8701, 55.627 l 55.6165,55.627 -231.245496,231.24803 c -127.185,127.1864 -231.5279,231.248 -231.873,231.248 -0.3451,0 -104.688, -104.0616 -231.873,-231.248 z" fill="currentColor"></path></g></svg></div><ul class="sc-cSHVUG eESBAu"><li><a href="#前言" class="">前言</a></li><li><a href="#critical-rendering-path" class="">critical-rendering-path</a></li><li><a href="#构建dom" class="">构建dom</a></li><li><a href="#构建cssom" class="">构建cssom</a></li><li><a href="#构建render-tree" class="">构建render-tree</a><ul><li><a href="#扩展：css匹配规则为何从右向左" class="">扩展：css匹配规则为何从右向左</a></li></ul></li><li><a href="#layout" class="">layout</a></li><li><a href="#paint" class="">paint</a></li><li><a href="#引入javascript" class="">引入javascript</a></li><li><a href="#使用chrome-dev-tools检测crp" class="">使用chrome-dev-tools检测crp</a><ul><li><a href="#0-代码部分" class="">0-代码部分</a></li><li><a href="#1-不加载js情况" class="">1-不加载js情况</a></li><li><a href="#2-引入js" class="">2-引入js</a></li><li><a href="#3-async-script" class="">3-async-script</a></li><li><a href="#4-css在html中不同位置的影响" class="">4-css在html中不同位置的影响</a></li></ul></li><li><a href="#总结" class="">总结</a></li><li><a href="#参考" class="">参考</a></li></ul></div></nav></div></div><div class="action-button sc-gZMcBi jlbquj"><div><div class="sc-gqjmRU bZeHhw"><div><svg class="" viewBox="0 0 926.23699 573.74994" version="1.1" width="15" height="15"><g transform="translate(904.92214,-879.1482)"><path d="m -673.67664,1221.6502 -231.2455,-231.24803 55.6165,-55.627 c 30.5891,-30.59485 56.1806,-55.627 56.8701,-55.627 0.6894,0 79.8637,78.60862 175.9427,174.68583 l 174.6892,174.6858 174.6892,-174.6858 c 96.079,-96.07721 175.253196,-174.68583 175.942696,-174.68583 0.6895,0 26.281,25.03215 56.8701,55.627 l 55.6165,55.627 -231.245496,231.24803 c -127.185,127.1864 -231.5279,231.248 -231.873,231.248 -0.3451,0 -104.688, -104.0616 -231.873,-231.248 z" fill="currentColor"></path></g></svg><svg class="" viewBox="0 0 926.23699 573.74994" version="1.1" width="15" height="15"><g transform="translate(904.92214,-879.1482)"><path d="m -673.67664,1221.6502 -231.2455,-231.24803 55.6165,-55.627 c 30.5891,-30.59485 56.1806,-55.627 56.8701,-55.627 0.6894,0 79.8637,78.60862 175.9427,174.68583 l 174.6892,174.6858 174.6892,-174.6858 c 96.079,-96.07721 175.253196,-174.68583 175.942696,-174.68583 0.6895,0 26.281,25.03215 56.8701,55.627 l 55.6165,55.627 -231.245496,231.24803 c -127.185,127.1864 -231.5279,231.248 -231.873,231.248 -0.3451,0 -104.688,-104.0616 -231.873,-231.248 z" fill="currentColor"></path></g></svg></div></div></div></div></div></aside></div></div></div></div><div class="sc-iwsKbI fIuKoY"><div><p>Feel free to leave me a message <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 492.719 492.719" height="15px"><g><path d="M492.719,166.008c0-73.486-59.573-133.056-133.059-133.056c-47.985,0-89.891,25.484-113.302,63.569    c-23.408-38.085-65.332-63.569-113.316-63.569C59.556,32.952,0,92.522,0,166.008c0,40.009,17.729,75.803,45.671,100.178    l188.545,188.553c3.22,3.22,7.587,5.029,12.142,5.029c4.555,0,8.922-1.809,12.142-5.029l188.545-188.553    C474.988,241.811,492.719,206.017,492.719,166.008z" fill="#FFFFFF"></path></g></svg><a href="https://github.com/tianzhich" target="_blank"> @tianzhich </a></p></div></div></div></div><script id="webpack-manifest">/*<![CDATA[*/window.webpackManifest={"231608221292675":"app-0e1cc0341dc892817918.js","107818501498521":"component---src-templates-blog-post-js-14060e765125310ecb9d.js","162898551421021":"component---src-pages-404-js-8e5aea5cd3509ab9fde8.js","137638538571168":"component---src-pages-fitness-js-e9fb0deb8a6198b03935.js","35783957827783":"component---src-pages-index-js-e1bab48f7bdddfe571dd.js","163474002598659":"component---src-pages-learning-js-487c010157b9e5abd65f.js","210863264062177":"component---src-pages-life-js-f70b2ab439829097e614.js","60335399758886":"path----afdd68c55cd83f110384.js","185328387226802":"path---life-2018-10-31-campus-recruitment-summary-7f010b5c913dd56ee9f4.js","14084931432379":"path---life-2018-12-31-2018-year-end-summary-62b2ab5f87841a0a8a3e.js","187507352487630":"path---life-2018-11-01-my-internship-in-insta-360-9522d2478bb12c09cc00.js","105628747647058":"path---learning-2018-08-17-why-js-01-02-not-equal-to-03-abb48faee96a90fb0b2a.js","117252040687834":"path---learning-2018-08-29-master-the-fed-interviews-java-script-14a15e89d46257534a0a.js","259631942176400":"path---learning-2018-08-22-the-magic-of-css-float-property-00e8f5d9e3b853484066.js","68432282983298":"path---learning-2018-09-08-master-the-fed-interviews-css-34be103efddcc44fabf3.js","122525428463767":"path---learning-2018-09-13-master-the-fed-interviews-react-067e2d8ed53447618353.js","140750986079233":"path---learning-2018-09-01-master-the-fed-interviews-computer-networking-e4473cb8ff484415f5d2.js","216963886073561":"path---learning-2018-09-16-http-caching-931340c30c8059591008.js","161495517759791":"path---learning-2018-09-11-document-flow-and-the-css-positioning-dc8f2935a9df998da826.js","147766044081179":"path---learning-2018-09-03-master-the-fed-interviews-algorithms-4098da4b0ec93076eba4.js","236278375703133":"path---learning-2019-01-27-simplify-the-file-creation-in-node-js-9d7e82c35ddca2f3acfb.js","224058518057538":"path---learning-2018-09-20-how-a-webpage-is-displayed-0cbdfea97b526d18735d.js","254022195166212":"path---404-a0e39f21c11f6a62c5ab.js","177823907933894":"path---fitness-582b2c50ebd5157dd0c7.js","142629428675168":"path---index-a0e39f21c11f6a62c5ab.js","145835162491587":"path---learning-9b04747c94b7d0661242.js","79702841818201":"path---life-8857366881278c3c19e6.js","178698757827068":"path---404-html-a0e39f21c11f6a62c5ab.js","114276838955818":"component---src-layouts-index-js-402b03e0db3e9461830c.js"}/*]]>*/</script><script>/*<![CDATA[*/["/blog/commons-b71de3ed6830857928d7.js","/blog/app-0e1cc0341dc892817918.js","/blog/path---learning-2018-09-20-how-a-webpage-is-displayed-0cbdfea97b526d18735d.js","/blog/component---src-templates-blog-post-js-14060e765125310ecb9d.js","/blog/component---src-layouts-index-js-402b03e0db3e9461830c.js"].forEach(function(s){document.write('<script src="'+s+'" defer></'+'script>')})/*]]>*/</script></body></html>